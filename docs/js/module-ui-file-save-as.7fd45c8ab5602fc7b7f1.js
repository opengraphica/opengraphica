"use strict";(self.webpackChunkOpenGraphica=self.webpackChunkOpenGraphica||[]).push([[7808],{45236:(e,a,l)=>{l.r(a),l.d(a,{default:()=>b});var t=l(66252),i=l(49963),o=l(3577);const n={class:"has-text-right"};var r=l(2262),s=l(26418),u=l(64670),m=l(9069),c=l(92056),f=l(97965),d=l(43019),v=l(10409),p=l(67340),k=l(91457),g=l(15683),w=l(98341);const y=(0,t.aZ)({name:"ModuleFileSaveAs",directives:{loading:d.ZP.directive},components:{ElAlert:s.ZP,ElButton:u.ZP,ElForm:m.ZP,ElFormItem:m.nH,ElFormItemGroup:c.Z,ElInput:f.default,ElSwitch:v.ZP},emits:["update:title","close"],setup(e,{emit:a}){a("update:title","module.fileSaveAs.title");const l=(0,k.$b)("$notify"),t=(0,r.iH)(),i=(0,r.iH)(!1),o=(0,r.qj)({workingFile:{saveBackDirectly:(0,r.iH)(!1),fileName:p.default.get("fileName")}}),n=p.default.get("fileHandle");let s=!(!n||!n.name.endsWith(".json"));return s&&(o.workingFile.saveBackDirectly=!0),{form:t,loading:i,canSaveBackDirectly:s,fileHandle:n,formData:o,formValidationRules:{},onCancel:function(){a("close")},onSave:async function(){if(t.value)try{await t.value.validate(),i.value=!0;try{o.workingFile.saveBackDirectly&&n?await(0,g.saveImage)(n):(p.default.set("fileName",o.workingFile.fileName.replace(w.z,"")),await(0,g.saveImageAs)({fileName:o.workingFile.fileName}))}catch(e){l({type:"error",dangerouslyUseHTMLString:!0,message:k.Ol})}a("close"),i.value=!1}catch(e){l({type:"error",dangerouslyUseHTMLString:!0,message:k.v7})}}}}}),b=(0,l(83744).Z)(y,[["render",function(e,a,l,r,s,u){const m=(0,t.up)("el-alert"),c=(0,t.up)("el-switch"),f=(0,t.up)("el-form-item"),d=(0,t.up)("el-input"),v=(0,t.up)("el-form-item-group"),p=(0,t.up)("el-button"),k=(0,t.up)("el-form"),g=(0,t.Q2)("loading");return(0,t.wy)(((0,t.wg)(),(0,t.j4)(k,{ref:"form",action:"javascript:void(0)","label-position":"left",model:e.formData.workingFile,rules:e.formValidationRules,novalidate:"novalidate","hide-required-asterisk":"",onSubmit:e.onSave},{default:(0,t.w5)((()=>[e.canSaveBackDirectly?((0,t.wg)(),(0,t.iD)(t.HY,{key:0},[(0,t.Wm)(m,{type:"info",title:e.$t("module.fileSaveAs.saveBackIntroduction",{fileName:e.fileHandle.name}),"show-icon":"",closable:!1,class:"mb-4"},null,8,["title"]),(0,t.Wm)(f,{label:e.$t("module.fileSaveAs.saveBackQuestion")},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{modelValue:e.formData.workingFile.saveBackDirectly,"onUpdate:modelValue":a[0]||(a[0]=a=>e.formData.workingFile.saveBackDirectly=a),"active-text":e.$t("button.yes"),"inactive-text":e.$t("button.no")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])],64)):((0,t.wg)(),(0,t.j4)(m,{key:1,type:"info",title:e.$t("module.fileSaveAs.exportDisclaimer"),"show-icon":"",closable:!1,class:"mb-4"},null,8,["title"])),(0,t.Wm)(i.Transition,{name:"scale-down"},{default:(0,t.w5)((()=>[e.formData.workingFile.saveBackDirectly?(0,t.kq)("v-if",!0):((0,t.wg)(),(0,t.j4)(v,{key:0},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{label:e.$t("module.fileSaveAs.fileName"),prop:"fileName"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{modelValue:e.formData.workingFile.fileName,"onUpdate:modelValue":a[1]||(a[1]=a=>e.formData.workingFile.fileName=a),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}))])),_:1}),(0,t._)("div",n,[(0,t.Wm)(p,{onClick:e.onCancel},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.toDisplayString)(e.$t("button.cancel")),1)])),_:1},8,["onClick"]),(0,t.Wm)(p,{type:"primary","native-type":"submit"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.toDisplayString)(e.$t("button.save")),1)])),_:1})])])),_:1},8,["model","rules","onSubmit"])),[[g,e.loading]])}]])}}]);