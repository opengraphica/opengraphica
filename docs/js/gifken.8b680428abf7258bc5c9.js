/*! For license information please see gifken.8b680428abf7258bc5c9.js.LICENSE.txt */
(self.webpackChunkOpenGraphica=self.webpackChunkOpenGraphica||[]).push([[187],{16705:function(t,e){!function(t){"use strict";class e{constructor(t,e,i){this.r=t,this.g=e,this.b=i}static createColorTable(t){const i=[];for(let i=1;i<=8;++i){const r=(i<<1)-t.length;for(let i=0;i<r;++i)t.push(new e(255,255,255))}return t.forEach((t=>{i.push(t.r),i.push(t.g),i.push(t.b)})),new Uint8Array(i)}}class i{static init(t,e){const r=new i;return r.transparentFlag=!1,r.delayCentiSeconds=0,r.transparentColorIndex=0,r.x=0,r.y=0,r.width=t||1,r.height=e||1,r.localTableSize=0,r.lzwCode=4,r.pixelData=new Uint8Array(r.width*r.height),r}decompress(){this.pixelData=this.lzwDecode(this.lzwCode,this.compressedData,this.width*this.height)}lzwDecode(t,e,i){let r=0;const o=function(t){let i=0;for(let o=0;o<t;++o)e[r>>3]&1<<(7&r)&&(i|=1<<o),++r;return i},s=new Uint8Array(i),n=1<<t,a=n+1;let l=t+1,h=[];const c=()=>{h=[],l=t+1;for(let t=0;t<n;++t)h[t]=[t];h[n]=[]};let f,u=0,p=0;for(;;)if(f=u,u=o(l),u!==n){if(u===a)break;if(u<h.length)f!==n&&h.push(h[f].concat(h[u][0]));else{if(u!==h.length)throw new Error("Invalid LZW code.");h.push(h[f].concat(h[f][0]))}s.set(h[u],p),p+=h[u].length,h.length===1<<l&&l<12&&l++}else c();return s}}var r;(r=t.GifVersion||(t.GifVersion={})).GIF89a="GIF89a",r.GIF87a="GIF87a";class o{static readHeader(e,i){String.fromCharCode(i.getUint8(0),i.getUint8(1),i.getUint8(2),i.getUint8(3),i.getUint8(4),i.getUint8(5))==t.GifVersion.GIF87a?e.version=t.GifVersion.GIF87a:e.version=t.GifVersion.GIF89a,e.width=i.getUint16(6,!0),e.height=i.getUint16(8,!0);const r=i.getUint8(10),o=128&r;let s;return s=128!==o?0:1<<1+(7&r),e.colorResolution=112&r,e.sortFlag=8==(8&r),e.bgColorIndex=i.getUint8(11),e.pixelAspectRatio=i.getUint8(12),128!==o?13:(e.globalColorTable=new Uint8Array(i.buffer,13,3*s),13+3*s)}static readBlock(t,e,r){const o=e.getUint8(r);if(59===o)return-1;if(33===o){let o;const s=e.getUint8(r+1);if(249===s)return void 0===t.frames[t.frameIndex1]?(o=new i,r=this.readGraphicControlExtensionBlock(o,e,r),t.frames.push(o)):(o=t.frames[t.frameIndex1],r=this.readGraphicControlExtensionBlock(o,e,r)),t.frameIndex1+=1,r;if(254===s)return this.readCommentExtensionBlock(e,r);if(255===s)return this.readApplicationExtensionBlock(t,e,r);if(1===s)return this.readPlainTextExtensionBlock(e,r)}if(44===o){let o;return void 0===t.frames[t.frameIndex2]?(o=new i,r=this.readImageBlock(o,e,r),t.frames.push(o)):(o=t.frames[t.frameIndex2],r=this.readImageBlock(o,e,r)),t.frameIndex2+=1,r}return-1}static readImageBlock(t,e,i){t.x=e.getUint16(++i,!0),i+=2,t.y=e.getUint16(i,!0),i+=2,t.width=e.getUint16(i,!0),i+=2,t.height=e.getUint16(i,!0),i+=2;const r=e.getUint8(i++);128==(128&r)?(t.localTableSize=1<<1+(7&r),t.localColorTable=new Uint8Array(e.buffer,i,3*t.localTableSize),i+=3*t.localTableSize):t.localTableSize=0,t.lzwCode=e.getUint8(i++);const o=new Array;let s=0;for(;;){const t=e.getUint8(i++);if(s+=t,0===t)break;o.push(new Uint8Array(e.buffer.slice(i,i+t))),i+=t}const n=new Uint8Array(s);n.set(o[0],0);let a=o[0].byteLength;for(let t=1,e=o.length;t<e;++t)n.set(o[t],a),a+=o[t].byteLength;return t.compressedData=n,i}static readApplicationExtensionBlock(t,e,i){if(i+=2,11!==e.getUint8(i++))throw new Error("faild: _readApplicationExtensionBlock");if("NETSCAPE2.0"===String.fromCharCode(e.getUint8(i++),e.getUint8(i++),e.getUint8(i++),e.getUint8(i++),e.getUint8(i++),e.getUint8(i++),e.getUint8(i++),e.getUint8(i++),e.getUint8(i++),e.getUint8(i++),e.getUint8(i++))){if(t.isLoop=!0,3!==e.getUint8(i++))throw new Error("faild: _readApplicationExtensionBlock (NETSCAPE2.0)");++i,t.loopCount=e.getUint16(i,!0),i+=2}for(;;){const t=e.getUint8(i++);if(0===t)break;i+=t}return i}static readCommentExtensionBlock(t,e){for(e+=2;;){const i=t.getUint8(e++);if(0===i)break;e+=i}return e}static readGraphicControlExtensionBlock(t,e,i){const r=e.getUint8(i+3);return t.transparentFlag=1==(1&r),t.delayCentiSeconds=e.getUint16(i+4,!0),t.transparentColorIndex=e.getUint8(i+6),i+8}static readPlainTextExtensionBlock(t,e){for(e+=2;;){const i=t.getUint8(e++);if(0===i)break;e+=i}return e}}class s{constructor(){this.__out=[],this.__remNumBits=0,this.__remVal=0}push(t,e){for(;e>0;)this.__remVal=(t<<this.__remNumBits&255)+this.__remVal,e+this.__remNumBits>=8?(this.__out.push(this.__remVal),e-=8-this.__remNumBits,t>>=8-this.__remNumBits,this.__remVal=0,this.__remNumBits=0):(this.__remNumBits=e+this.__remNumBits,e=0)}flush(){this.push(0,8),this.__remNumBits=0,this.__remVal=0;const t=this.__out;return this.__out=[],t}}class n{constructor(i){this.frameIndex1=0,this.frameIndex2=0,this.frames=[],i||(this._version=t.GifVersion.GIF89a,this._width=1,this._height=1,this.colorResolution=112,this.sortFlag=!1,this.bgColorIndex=1,this.pixelAspectRatio=0,this.globalColorTable=e.createColorTable([new e(0,0,0),new e(255,255,255)]))}static parse(t){const e=new n(!0),i=new DataView(t);let r=o.readHeader(e,i);for(;r=o.readBlock(e,i,r),-1!==r;);return e}versionName(){return t.GifVersion[this._version]}get version(){return this._version}set version(t){this._version=t}get width(){return this._width}set width(t){if((t=~~t)>65535||t<0)throw new RangeError("width range error: "+t);this._width=t}get height(){return this._height}set height(t){if((t=~~t)>65535||t<0)throw new RangeError("height range error: "+t);this._height=t}get globalColorTable(){return this._globalColorTable}set globalColorTable(t){this._globalColorTable=t,this._globalTableSize=t.byteLength/3,void 0===this.bgColorIndex&&(this.bgColorIndex=this._globalTableSize-1)}get globalTableSize(){return this._globalTableSize}get loopCount(){return this._loopCount}set loopCount(t){if((t=~~t)>65535||t<0)throw new RangeError("loopCount range error: "+t);this._loopCount=t}writeToArrayBuffer(){return n.writeToArrayBuffer(this)}static writeToArrayBuffer(e){const i=[],r=new DataView(new ArrayBuffer(13));r.setUint8(0,71),r.setUint8(1,73),r.setUint8(2,70),r.setUint8(3,56),e.version===t.GifVersion.GIF89a?r.setUint8(4,57):r.setUint8(4,55),r.setUint8(5,97),r.setUint16(6,e.width,!0),r.setUint16(8,e.height,!0);let o=0,s=e.globalTableSize;if(s>0){o|=128;let t=0;do{s>>=1,++t}while(s>1);o|=t-1}if(o|=e.colorResolution,e.sortFlag&&(o|=8),r.setUint8(10,o),r.setUint8(11,e.bgColorIndex),r.setUint8(12,e.pixelAspectRatio),i.push(new Uint8Array(r.buffer)),e.globalTableSize>0&&i.push(e.globalColorTable),e.isLoop){const t=new DataView(new ArrayBuffer(19));t.setUint8(0,33),t.setUint8(1,255),t.setUint8(2,11),t.setUint8(3,78),t.setUint8(4,69),t.setUint8(5,84),t.setUint8(6,83),t.setUint8(7,67),t.setUint8(8,65),t.setUint8(9,80),t.setUint8(10,69),t.setUint8(11,50),t.setUint8(12,46),t.setUint8(13,48),t.setUint8(14,3),t.setUint8(15,1),t.setUint16(16,e.loopCount,!0),t.setUint8(18,0),i.push(new Uint8Array(t.buffer))}return e.frames.forEach((t=>{const e=new DataView(new ArrayBuffer(18));if(e.setUint8(0,33),e.setUint8(1,249),e.setUint8(2,4),t.transparentFlag?e.setUint8(3,1):e.setUint8(3,0),e.setUint16(4,t.delayCentiSeconds,!0),e.setUint8(6,t.transparentColorIndex),e.setUint8(7,0),e.setUint8(8,44),e.setUint16(9,t.x,!0),e.setUint16(11,t.y,!0),e.setUint16(13,t.width,!0),e.setUint16(15,t.height,!0),t.localTableSize>0){let i=0,r=t.localTableSize;do{r>>=1,++i}while(r>1);e.setUint8(17,128|i-1)}else e.setUint8(17,0);if(i.push(new Uint8Array(e.buffer)),t.localTableSize>0&&i.push(t.localColorTable),i.push(new Uint8Array([t.lzwCode])),void 0===t.compressedData&&void 0===t.pixelData)throw new Error("no image data");let r=0,o=t.compressedData;o=o instanceof Array?new Uint8Array(o):o||new Uint8Array(n.compressWithLZW(t.pixelData,t.lzwCode));const s=o.length;for(;;){if(s>r+255){i.push(new Uint8Array([255])),i.push(o.subarray(r,r+255)),r+=255;continue}const t=o.subarray(r);i.push(new Uint8Array([t.byteLength])),i.push(t);break}i.push(new Uint8Array([0]))})),i.push(new Uint8Array([59])),i}writeToArray(){const t=n.writeToArrayBuffer(this),e=[];return t.forEach((t=>{for(let i=0,r=t.byteLength;i<r;++i)e.push(t[i])})),e}split(t){const e=[];return t?this.frames.forEach(((t,i)=>{const r=new n;if(r.version=this._version,r.width=this._width,r.height=this._height,r.colorResolution=this.colorResolution,r.sortFlag=this.sortFlag,r.bgColorIndex=this.bgColorIndex,r.pixelAspectRatio=this.pixelAspectRatio,r.globalColorTable=this._globalColorTable,0!==i&&t.transparentFlag){void 0===t.pixelData&&t.decompress(),void 0===this.frames[i-1].pixelData&&this.frames[i-1].decompress();let e=!1;for(let r=0,o=t.pixelData.length;r<o;++r)t.pixelData[r]===t.transparentColorIndex&&(t.pixelData[r]=this.frames[i-1].pixelData[r],e=!0);if(e){const e=n.compressWithLZW(t.pixelData,t.lzwCode);t.compressedData=new Uint8Array(e)}delete t.pixelData}r.frames=[t],e.push(r)})):this.frames.forEach((t=>{const i=new n;i.version=this._version,i.width=this._width,i.height=this._height,i.colorResolution=this.colorResolution,i.sortFlag=this.sortFlag,i.bgColorIndex=this.bgColorIndex,i.pixelAspectRatio=this.pixelAspectRatio,i.globalColorTable=this._globalColorTable,i.frames=[t],e.push(i)})),e}playback(t){const e=new n;return t&&this.frames.forEach(((t,e)=>{if(0!==e&&t.transparentFlag){void 0===t.pixelData&&t.decompress(),void 0===this.frames[e-1].pixelData&&this.frames[e-1].decompress();let i=!1;for(let r=0,o=t.pixelData.length;r<o;++r)t.pixelData[r]===t.transparentColorIndex&&(t.pixelData[r]=this.frames[e-1].pixelData[r],i=!0);if(i){const e=n.compressWithLZW(t.pixelData,t.lzwCode);t.compressedData=new Uint8Array(e)}delete t.pixelData}})),e.version=this._version,e.width=this._width,e.height=this._height,e.colorResolution=this.colorResolution,e.sortFlag=this.sortFlag,e.bgColorIndex=this.bgColorIndex,e.pixelAspectRatio=this.pixelAspectRatio,e.globalColorTable=this._globalColorTable,e.frames=this.frames.reverse(),e.isLoop=this.isLoop,e.loopCount=this._loopCount,e}static compressWithLZW(t,e){const i=new s,r=1<<e,o=r+1;let n=o+1,a=e+1,l=Object.create(null);function h(){n=o+1,a=e+1,l=Object.create(null)}h(),i.push(r,a);let c="";for(let e=0,o=t.length;e<o;++e){const o=t[e],s=String.fromCharCode(o);s in l||(l[s]=o);const f=c;c+=s,c in l||(i.push(l[f],a),n<=4095?(l[c]=n,n===1<<a&&a++,n++):(i.push(r,a),h(),l[s]=o),c=s)}return i.push(l[c],a),i.push(o,a),i.flush()}}var a,l,h,c=(a=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r="undefined"!=typeof window&&void 0!==window.document,o="object"===("undefined"==typeof self?"undefined":i(self))&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,s="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node;e.isBrowser=r,e.isWebWorker=o,e.isNode=s},a(l={exports:{}},l.exports),l.exports);(h=c)&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")&&h.default;var f=c.isBrowser,u=c.isWebWorker;c.isNode;class p{static writeToBlob(t){if(f||u||"function"==typeof Blob)return new Blob(t,{type:"image/gif"});throw new Error("writeToBlob is browser-only function")}static writeToDataUrl(t){if(f||u){let e="";return t.forEach((t=>{const i=[];for(let e=0,r=t.byteLength;e<r;++e)i.push(t[e]);e+=String.fromCharCode.apply(null,i)})),"data:image/gif;base64,"+btoa(e)}return"data:image/gif;base64,"+Buffer.from(t).toString("base64")}}const g={Gif:n,GifColor:e,GifFrame:i,GifParser:o,GifVersion:t.GifVersion,GifPresenter:p};t.Gif=n,t.GifColor=e,t.GifFrame=i,t.GifParser=o,t.GifPresenter=p,t.default=g,Object.defineProperty(t,"__esModule",{value:!0})}(e)}}]);