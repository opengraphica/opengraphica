/*! For license information please see opengraphica.d536feba88b4c8950846.js.LICENSE.txt */
var OpenGraphica;(self.webpackChunkOpenGraphica=self.webpackChunkOpenGraphica||[]).push([[9334],{84510:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>l});var a=o(62195),n=o(91648),i=o(22053),r=o(75720),s=o(78835);class l extends a.default{lastCursorX=0;lastCursorY=0;moveTranslateStart=null;moveTouchDistanceStart=0;moveTouchDistanceLatest=0;moveScaleStart=1;moveTouchAngleStart=0;moveTouchAngleLatest=0;moveRotationStart=0;moveTouchCountTracker=0;constructor(){super(),this.zoomCanvas=(0,r.P)(this.zoomCanvas,20)}onPointerDown(e){super.onPointerDown(e);const t=window.devicePixelRatio||1;if(this.touches,e.isPrimary&&(this.lastCursorX=e.pageX,this.lastCursorY=e.pageY),"mouse"===e.pointerType&&(1===e.button||2===e.button)){const o=n.Z.get("transform");this.moveTranslateStart=new DOMPoint(this.lastCursorX*t,this.lastCursorY*t).matrixTransform(o.inverse()),this.handleCursorIcon(),n.Z.set("cursorX",e.pageX*t),n.Z.set("cursorY",e.pageY*t),n.Z.set("viewDirty",!0)}}onMultiTouchDown(){super.onMultiTouchDown();const e=window.devicePixelRatio||1,t=this.touches;if(2===t.length){this.lastCursorX=(t[0].down.pageX+t[1].down.pageX)/2,this.lastCursorY=(t[0].down.pageY+t[1].down.pageY)/2;const o=n.Z.get("transform");this.moveTranslateStart=new DOMPoint(this.lastCursorX*e,this.lastCursorY*e).matrixTransform(o.inverse()),this.moveTouchDistanceStart=(0,s.y)(t[0].down.pageX,t[0].down.pageY,t[1].down.pageX,t[1].down.pageY),this.moveTouchAngleStart=Math.atan2(t[1].down.pageY-t[0].down.pageY,t[1].down.pageX-t[0].down.pageX);const a=n.Z.get("decomposedTransform");this.moveScaleStart=a.scaleX,this.moveRotationStart=a.rotation,this.moveTouchCountTracker=2}}onMultiTouchUp(){this.moveTranslateStart&&(this.moveTranslateStart=null)}onPointerMove(e){super.onPointerMove(e);const t=window.devicePixelRatio||1;if(e.isPrimary&&(this.lastCursorX=e.pageX,this.lastCursorY=e.pageY),this.moveTranslateStart){const o=this.touches;if(o.length>0){const e=this.moveTouchCountTracker!=this.touches.length;this.moveTouchCountTracker=o.length;const a=o[0].move||o[0].down,r=o[1]&&(o[1].move||o[1].down);let l=a.x,c=a.y;if(r&&(l=(a.x+r.x)/2,c=(a.y+r.y)/2),e){const e=n.Z.get("transform");if(this.moveTranslateStart=new DOMPoint(l*t,c*t).matrixTransform(e.inverse()),o.length>1){this.moveTouchDistanceStart=(0,s.y)(a.pageX,a.pageY,r.pageX,r.pageY),this.moveTouchAngleStart=Math.atan2(r.pageY-a.pageY,r.pageX-a.pageX);const e=n.Z.get("decomposedTransform");this.moveScaleStart=e.scaleX,this.moveRotationStart=e.rotation}}this.lastCursorX=l,this.lastCursorY=c;const u=new DOMMatrix([1,0,0,1,0,0]),d=new DOMPoint(this.lastCursorX*t,this.lastCursorY*t).matrixTransform(u.inverse());u.translateSelf(d.x-this.moveTranslateStart.x,d.y-this.moveTranslateStart.y);let p=this.moveTouchDistanceLatest;o.length>=2&&(p=(0,s.y)(a.x,a.y,r.x,r.y)),this.moveTouchDistanceLatest=p;const m=p/this.moveTouchDistanceStart,h=i.Z.get("touchRotation");let g=0;if("on"===h||"snap"===h){let e=this.moveTouchAngleLatest;if(o.length>=2&&(e=Math.atan2(r.y-a.y,r.x-a.x)),this.moveTouchAngleLatest=e,g=e-this.moveTouchAngleStart,"snap"===h){let e=this.moveRotationStart+g;e=Math.round(e/(Math.PI/24))*(Math.PI/24),g=-this.moveRotationStart+e}}const f=new DOMPoint(this.lastCursorX*t,this.lastCursorY*t).matrixTransform(u.inverse());u.translateSelf(f.x,f.y),u.scaleSelf(this.moveScaleStart*m,this.moveScaleStart*m),u.rotateSelf((this.moveRotationStart+g)*Math.RADIANS_TO_DEGREES),u.translateSelf(-f.x,-f.y),n.Z.set("transform",u),n.Z.set("viewDirty",!0)}else if("mouse"===e.pointerType){const o=n.Z.get("transform"),a=new DOMPoint(this.lastCursorX*t,this.lastCursorY*t).matrixTransform(o.inverse());o.translateSelf(a.x-this.moveTranslateStart.x,a.y-this.moveTranslateStart.y),n.Z.set("transform",o),n.Z.set("cursorX",e.pageX*t),n.Z.set("cursorY",e.pageY*t),n.Z.set("viewDirty",!0)}}}onPointerUp(e){super.onPointerUp(e),this.moveTranslateStart&&("mouse"!==e.pointerType||1!==e.button&&2!==e.button||(this.moveTranslateStart=null,this.handleCursorIcon())),n.Z.set("viewDirty",!0)}onWheel(e){super.onWheel(e);const t=e.deltaY?e.deltaY/40:-e.detail?e.detail:0;t&&this.zoomCanvas(-t/Math.abs(t)),e.preventDefault()}zoomCanvas(e){const t=window.devicePixelRatio||1,o=n.Z.get("transform"),a=new DOMPoint(this.lastCursorX*t,this.lastCursorY*t).matrixTransform(o.inverse());o.translateSelf(a.x,a.y);const i=Math.pow(1.1,e);o.scaleSelf(i,i),o.translateSelf(-a.x,-a.y),n.Z.set("transform",o),n.Z.set("viewDirty",!0)}handleCursorIcon(){let e=super.handleCursorIcon();return e||this.moveTranslateStart&&(e="grabbing"),n.Z.set("cursor",e),e}}},62195:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>l});var a=o(66252),n=o(91648),i=o(22053),r=o(95452),s=o(84710);class l{canvas;ctx;pointers=[];touches=[];multiTouchDownCount=0;multiTouchDownTimeoutHandle;multiTouchTapTimeoutHandle;dragStartRadius=i.Z.get("dragStartRadius");onEnter(){this.handleCursorIcon(),setTimeout((async()=>{await(0,a.Y3)();const e=n.Z.get("transformResetOptions");e&&r.Z.emit("app.canvas.resetTransform",!0!==e?e:void 0)}),0)}onLeave(){n.Z.set("cursor",null)}onMultiTouchDown(){this.multiTouchDownCount=this.touches.length;const e=[...this.touches];clearTimeout(this.multiTouchTapTimeoutHandle),this.multiTouchTapTimeoutHandle=window.setTimeout((()=>{this.multiTouchDownTimeoutHandle=void 0,this.multiTouchTapTimeoutHandle=void 0,this.purgeTouches(),0===this.touches.length&&this.onMultiTouchTap(e)}),i.Z.get("multiTouchTapTimeout"))}onMultiTouchUp(){}onMultiTouchTap(e){}onPointerDown(e){if((0,s.u7)(e.target))return;const t={id:e.pointerId,type:e.pointerType,primary:e.isPrimary,isDragging:!1,down:e,downTimestamp:window.performance.now()};this.pointers.push(t),this.dragStartRadius=i.Z.get("dragStartRadius"),"touch"===e.pointerType&&(this.multiTouchDownTimeoutHandle||0!==this.touches.length?this.touches.push(t):(this.touches=[t],this.multiTouchDownTimeoutHandle=window.setTimeout((()=>{this.onMultiTouchDown()}),i.Z.get("multiTouchDownTimeout")))),n.Z.set("preventPostProcess",!0)}onPointerDragStart(e){}onPointerMove(e){const t=window.devicePixelRatio||1,o=this.pointers.filter((t=>t.id===e.pointerId))[0];o&&(o.movePrev=o.move,o.move=e,(Math.abs(o.down.pageX-o.move.pageX)>=this.dragStartRadius*t||Math.abs(o.down.pageY-o.move.pageY)>=this.dragStartRadius*t)&&(o.isDragging||(o.isDragging=!0,this.onPointerDragStart(e))))}onPointerUp(e){const t=this.pointers.filter((t=>t.id===e.pointerId))[0];t&&(t.up=e),this.onPointerUpBeforePurge(e);const o=this.pointers.findIndex((t=>t.id===e.pointerId));o>-1&&this.pointers.splice(o,1),this.purgeTouches(),0===this.pointers.length&&n.Z.set("preventPostProcess",!1)}onPointerUpBeforePurge(e){}onWheel(e){}purgeTouches(){if(!this.multiTouchDownTimeoutHandle){if(0===this.pointers.filter((e=>"touch"===e.type)).length)this.touches=[];else if(0!==this.touches.length)for(let e=this.touches.length-1;e>=0;e--){const t=this.touches[e];-1===this.pointers.findIndex((e=>e.id===t.id))&&this.touches.splice(e,1)}this.multiTouchDownCount>0&&0===this.touches.length&&(this.onMultiTouchUp(),this.multiTouchDownCount=0)}}handleCursorIcon(){return null}}},2521:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>T});var a=o(91648),n=o(22053),i=o(67340);class r{attach(e){this.onAttach(e)}onAttach(e){}detach(){this.onDetach()}onDetach(){}reorder(e){this.onReorder(e)}onReorder(e){}update(e){this.onUpdate(e),a.Z.set("dirty",!0)}onUpdate(e){}draw(e,t,o={}){if((o.visible||t.visible)&&(!o.selectedLayersOnly||i.default.get("selectedLayerIds").includes(t.id))){o.selectionTest&&(o.force2dRenderer=!0);const r=e.canvas;if(n.Z.get("enableMultiLayerBuffer")&&!a.Z.get("useCssViewport")&&a.Z.get("decomposedTransform").scaleX<1){const o=a.Z.get("isBufferInUse");"raster"===t.type?(e=a.Z.get("bufferCtx"),o||(a.Z.set("isBufferInUse",!0),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,i.default.get("width"),i.default.get("height")))):"group"!==t.type&&o&&(a.Z.set("isBufferInUse",!1),e.drawImage(a.Z.get("bufferCanvas"),0,0))}"raster"!==t.type&&"rasterSequence"!==t.type&&"group"!==t.type&&a.Z.set("isDisplayingNonRasterLayer",!0),o.selectionTest&&(e.save(),e.setTransform(new DOMMatrix),e.clearRect(0,0,r.width,r.height),e.restore()),e.save(),e.globalAlpha=t.opacity,e.globalCompositeOperation=t.blendingMode;const s=e.imageSmoothingEnabled;if(s&&(e.imageSmoothingEnabled=!1),t.transform.isIdentity||e.transform(t.transform.a,t.transform.b,t.transform.c,t.transform.d,t.transform.e,t.transform.f),this.onDraw(e,t,o),s&&(e.imageSmoothingEnabled=!0),o.selectionTest&&"group"!==t.type){const a=e.getImageData(o.selectionTest.point.x,o.selectionTest.point.y,1,1).data.slice(0,4);(!o.selectionTest.resultPixelTest||a[3]>0)&&(o.selectionTest.resultId=t.id,o.selectionTest.resultPixelTest=a)}e.restore()}}onDraw(e,t,o={}){}}var s=o(37818),l=o(63063),c=o(40139);class u{reorder(e){this.onReorder(e)}onReorder(e){}attach(e){this.onAttach(e)}onAttach(e){}detach(){this.onDetach()}onDetach(){}update(e){this.onUpdate(e)}onUpdate(e){}draw(e,t,o={}){this.onDraw(e,t,o)}onDraw(e,t,o={}){}}var d=o(2262),p=o(66252),m=o(95699),h=o(4430);class g extends m.u{parameters;constructor(e=1,t=1){super(),this.type="ImagePlaneGeometry",this.parameters={width:e,height:t};const o=[],a=[],n=[],i=[];for(let o=0;o<2;o++){const r=o*t;for(let t=0;t<2;t++){const s=t*e;a.push(s,r,0),n.push(0,0,1),i.push(t),i.push(1-o)}}for(let e=0;e<1;e++)for(let t=0;t<1;t++){const a=t+2*e,n=t+2*(e+1),i=t+1+2*(e+1),r=t+1+2*e;o.push(a,n,r),o.push(n,i,r)}this.setIndex(o),this.setAttribute("position",new h.a$(a,3)),this.setAttribute("normal",new h.a$(n,3)),this.setAttribute("uv",new h.a$(i,2))}static fromJSON(e){return new g(e.width,e.height)}}var f=o(84033),v=o(27006),y=o(71123),w=o(48186),b=o(18292);const T={"2d":{base:r,empty:r,group:class extends r{layerRenderers;async onAttach(){this.layerRenderers=(await Promise.resolve().then(o.bind(o,2521))).default}onDraw(e,t,o={}){const a=t.layers;for(const t of a)o.force2dRenderer?(new this.layerRenderers["2d"][t.type]).draw(e,t,o):t.renderer.draw(e,t,o)}},raster:class extends r{onDraw(e,t,o={}){e.drawImage(t.data.draftImage||t.bakedImage||t.data.sourceImage,0,0,t.width,t.height)}},rasterSequence:class extends r{onDraw(e,t,o={}){const a=t.data.currentFrame;a&&e.drawImage(a.draftImage||t.bakedImage||a.sourceImage,0,0,t.width,t.height)}},text:class extends r{getWrapText(e){let t="";for(let o=0;o<e.spans.length;o++)t+=e.spans[o].text;return t}calculateTextPlacement(e,t){const o=t.data.boundary,a=t.data.baseDirection,n=(t.data.wrapDirection,["ltr","rtl"].includes(a));["rtl","btt"].includes(a);let i=0,r=0,c=n?t.width:t.height;const u={wrapSizes:[],lines:[]};for(const a of t.data.lines){let r=0,d=[0],p=[],m=[...a.spans],h=null,g=null,f=null,v=0,y=0;for(y=0;y<m.length;y++){const a=m[y],u=a.meta.tracking||s.$L.tracking,w=a.meta.family||s.$L.family,b=a.meta.size||s.$L.size;h=(0,l.Uf)(w,b,!s.kz.get(w)),n&&(e.font=" "+(a.meta.style?a.meta.style:"normal")+" "+(a.meta.weight?a.meta.weight:"")+" "+b+"px "+w);for(let l=0;l<a.text.length;l++){if(g=a.text[l],"metrics"===t.data.kerning){if(f=a.text[l+1],!f&&l===a.text.length-1&&m[y+1]){const e=m[y+1];w===(e.meta.family||s.$L.family)&&b===(e.meta.size||s.$L.size)&&(f=e.text[0])}v=n&&f?h.getKerningOffset(g+f):0}if(r+=(n?e.measureText(g).width:h.offsetHeight)+v+u,"dynamic"!==o&&r>c&&![" ","-"].includes(g)){let e=-1,o=y;for(;o>=0;o--){const t=m[o],a=o===y?t.text.substring(0,l):t.text;e=a.lastIndexOf(" ");const n=a.lastIndexOf("-");if(n>e&&(e=n),e>-1)break}let a=[],n=[];if(e>-1){a=m.slice(0,o),n=m.slice(o+1);const t=m[o].text.substring(0,e+1),i=m[o].text.substring(e+1);t.length>0&&a.push({text:t,meta:m[o].meta}),i.length>0&&n.unshift({text:i,meta:m[o].meta})}else{if("word"===t.data.wrapAt){d.push(r);break}{0===y&&0===l&&(l++,d.push(r)),a=m.slice(0,y),n=m.slice(y+1);const e=m[y].text.substring(0,l),t=m[y].text.substring(l);e.length>0&&a.push({text:e,meta:m[y].meta}),t.length>0&&n.unshift({text:t,meta:m[y].meta})}}let s=d[d.length-1];s>i&&(i=s);const c={characterOffsets:d,spans:a};c.characterOffsets=c.characterOffsets.slice(0,this.getWrapText(c).length+1),p.push(c),m=n,r=0,d=[0],y=-1;break}d.push(r)}}if(m.length>0){let e=d[d.length-1];e>i&&(i=e),p.push({characterOffsets:d,spans:m})}u.lines.push({align:a.align,firstWrapIndex:0,wraps:p})}const d="dynamic"===o?i:n?t.width:t.height;for(let e of u.lines)for(let t of e.wraps){const o=t.spans[t.spans.length-1],a=t.characterOffsets[t.characterOffsets.length-1-(" "===o.text[o.text.length-1]?1:0)];let n=0;if("center"===e.align?n=d/2-a/2:"end"===e.align&&(n=d-a),n>0)for(let e=0;e<t.characterOffsets.length;e++)t.characterOffsets[e]+=n}let p=0,m=0;for(let t of u.lines){t.firstWrapIndex=m;for(let o of t.wraps){let t=0,a=0;for(let i of o.spans){let o=null;const r=i.meta.family||s.$L.family,c=i.meta.size||s.$L.size,u=null!=i.meta.leading?i.meta.leading:s.$L.leading;n?o=(0,l.Uf)(r,c,!s.kz.get(r)):e.font=" "+(i.meta.style?i.meta.style:"normal")+" "+(i.meta.weight?i.meta.weight:"")+" "+(i.meta.size||s.$L.size)+"px "+r;let d=n&&o?o.baseline:e.measureText("X").width,p=n&&o?Math.abs(o.baseline-o.offsetHeight):e.measureText("x").width;u&&(d+=u,d<0&&(p+=d,d=0,p<0&&(p=0))),d>t&&(t=d),p>a&&(a=p)}let i=t+a;u.wrapSizes.push({size:i,offset:p,baseline:t}),p+=i,m++}}r=p;let h=s.Gu.get(t);return h||(h={}),h.lastCalculatedLayerWidth=t.width,h.lastCalculatedLayerHeight=t.height,h.textBoundaryWidth=Math.max(1,Math.round(n?i:r)),h.textBoundaryHeight=Math.max(1,Math.round(n?r:i)),h.renderInfo=u,h}onDraw(e,t,o={}){if(t.bakedImage)e.drawImage(t.bakedImage,0,0,t.width,t.height);else{const{renderInfo:o}=this.calculateTextPlacement(e,t);if(!o)return;try{e.textAlign="left",e.textBaseline="alphabetic";const a=t.data.boundary;let n=0,r=0;const u=t.data.baseDirection,d=(t.data.wrapDirection,["ltr","rtl"].includes(u)),p=(["rtl","btt"].includes(u),o.wrapSizes);let m=0,h=0;const g=0,f=0;for(let t of o.lines){let o=0;for(let[u,v]of t.wraps.entries()){let t=null,u=null,y=null,w=0;const b=v.characterOffsets;for(let[T,k]of v.spans.entries()){const v=null!=k.meta.tracking?k.meta.tracking:s.$L.tracking,T=null!=k.meta.weight?k.meta.weight:s.$L.weight,C=null!=k.meta.style?k.meta.style:s.$L.style,S=null!=k.meta.underline?k.meta.underline:s.$L.underline,x=null!=k.meta.strikethrough?k.meta.strikethrough:s.$L.strikethrough,D=k.meta.family||s.$L.family,P=k.meta.size||s.$L.size;let R;s.kz.get(D),(S||x)&&(R=(0,l.Uf)(D,P,!s.kz.get(D))),e.font=" "+(C||"normal")+" "+(T||"")+" "+Math.round(k.meta.size||s.$L.size)+"px "+D;const L=(0,c.nq)(k.meta.fillColor||s.$L.fillColor,i.default.state.colorModel,i.default.state.colorSpace);let M="";L.startsWith("#")&&(M=L);const A=null!=k.meta.strokeSize?k.meta.strokeSize:s.$L.strokeSize;let Z="";if(A){const t=(0,c.nq)(k.meta.strokeColor||s.$L.strokeColor,i.default.state.colorModel,i.default.state.colorSpace);t.startsWith("#")&&(Z=t),e.lineWidth=A}else e.lineWidth=0;for(let t=0;t<k.text.length;t++){const a=k.text.charAt(t),i=(Math.round(n+p[h].offset),b[w+1]-b[w]),s=(Math.round(p[h].size),r+b[w]),l=Math.round(n+p[h].offset+p[h].baseline),c=d?s+v:l,u=d?l:s+v;e.fillStyle=M,e.strokeStyle=Z,e.fillText(a,c,u),A&&(e.lineWidth=A,e.strokeText(a,c,u)),x&&R&&(e.fillStyle=M,e.lineWidth=Math.max(1,R.offsetHeight/20),e.fillRect(c-.25-v,u-.28*R.offsetHeight,i+.5,e.lineWidth)),S&&R&&(e.fillStyle=M,e.lineWidth=Math.max(1,R.offsetHeight/20),e.fillRect(c-.25-v,u+e.lineWidth,i+.5,e.lineWidth)),w++,o++}if(0===k.text.length&&g===m&&f===o){const e=Math.round(n+p[h].offset),o=r+b[0]+(0===m?"dynamic"===a?5:2:0),i=3,s=Math.round(p[h].size);t=(d?o:e)-.5,u=(d?e:o)-.5,y=d?s:i}}h++}m++}}catch(e){console.warn(e)}}}},vector:r},webgl:{base:u,empty:u,group:class extends u{onUpdate(e){}onDraw(e,t,o={}){}},raster:class extends u{stopWatchVisible;stopWatchSize;stopWatchTransform;stopWatchData;planeGeometry;material;plane;draftTexture;bakedTexture;sourceTexture;onAttach(e){this.material=new f.v({transparent:!0,side:v.ehD}),this.plane=new y.K(this.planeGeometry,this.material),this.plane.matrixAutoUpdate=!1,a.Z.get("threejsScene")?.add(this.plane);const{visible:t,width:o,height:n,transform:i,data:r}=(0,d.BK)(e);this.stopWatchVisible=(0,p.YP)([t],(([e])=>{this.update({visible:e})}),{immediate:!0}),this.stopWatchSize=(0,p.YP)([o,n],(([e,t])=>{this.update({width:e,height:t})}),{immediate:!0}),this.stopWatchTransform=(0,p.YP)([i],(([e])=>{this.update({transform:e})}),{immediate:!0}),this.stopWatchData=(0,p.YP)([r],(()=>{this.update({data:e.data})}),{deep:!0,immediate:!0})}onReorder(e){this.plane&&(this.plane.renderOrder=e)}update(e){super.update(e)}onUpdate(e){if(null!=e.visible&&this.plane&&(this.plane.visible=e.visible),e.width||e.height){const t=e.width||this.planeGeometry?.parameters.width,o=e.height||this.planeGeometry?.parameters.height;this.planeGeometry?.dispose(),this.planeGeometry=new g(t,o),this.plane&&(this.plane.geometry=this.planeGeometry)}e.transform&&this.plane?.matrix.set(e.transform.m11,e.transform.m21,e.transform.m31,e.transform.m41,e.transform.m12,e.transform.m22,e.transform.m32,e.transform.m42,e.transform.m13,e.transform.m23,e.transform.m33,e.transform.m43,e.transform.m14,e.transform.m24,e.transform.m34,e.transform.m44),e.data&&(e.data.draftImage?(this.draftTexture?.dispose(),this.draftTexture=new b.R(e.data.draftImage),this.draftTexture.magFilter=v.TyD,this.material&&(this.material.map=this.draftTexture)):(this.draftTexture&&(this.draftTexture.dispose(),this.draftTexture=void 0),e.data.sourceImage?(this.sourceTexture?.dispose(),this.sourceTexture=(new w.d).load(e.data.sourceImage.src,(()=>{a.Z.set("dirty",!0)})),this.sourceTexture.magFilter=v.TyD,this.material&&(this.material.map=this.sourceTexture)):(this.sourceTexture&&(this.sourceTexture.dispose(),this.sourceTexture=void 0),this.material&&(this.material.map=null))))}onDetach(){this.planeGeometry?.dispose(),this.planeGeometry=void 0,this.plane&&a.Z.get("threejsScene")?.remove(this.plane),this.plane=void 0,this.material=void 0,this.draftTexture?.dispose(),this.draftTexture=void 0,this.sourceTexture?.dispose(),this.sourceTexture=void 0,this.stopWatchVisible?.(),this.stopWatchSize?.(),this.stopWatchTransform?.(),this.stopWatchData?.()}},rasterSequence:class extends u{stopWatchVisible;stopWatchSize;stopWatchTransform;stopWatchData;planeGeometry;material;plane;lastUpdatedFrame;textureCanvas;textureCtx;texture;onAttach(e){this.material=new f.v({transparent:!0,side:v.ehD}),this.plane=new y.K(this.planeGeometry,this.material),this.plane.matrixAutoUpdate=!1,a.Z.get("threejsScene")?.add(this.plane),this.textureCanvas=document.createElement("canvas"),this.textureCanvas.width=e.data.currentFrame?.sourceImage?.width||10,this.textureCanvas.height=e.data.currentFrame?.sourceImage?.height||10,this.textureCtx=this.textureCanvas.getContext("2d")||void 0,this.textureCtx&&(this.textureCtx.imageSmoothingEnabled=!1),this.texture?.dispose(),this.texture=new b.R(this.textureCanvas),this.texture.magFilter=v.TyD,this.material&&(this.material.map=this.texture);const{visible:t,width:o,height:n,transform:i,data:r}=(0,d.BK)(e);this.stopWatchVisible=(0,p.YP)([t],(([e])=>{this.update({visible:e})}),{immediate:!0}),this.stopWatchSize=(0,p.YP)([o,n],(([e,t])=>{this.update({width:e,height:t})}),{immediate:!0}),this.stopWatchTransform=(0,p.YP)([i],(([e])=>{this.update({transform:e})}),{immediate:!0}),this.stopWatchData=(0,p.YP)([r],(()=>{this.update({data:e.data})}),{deep:!0,immediate:!0})}onReorder(e){this.plane&&(this.plane.renderOrder=e)}update(e){super.update(e)}onUpdate(e){if(null!=e.visible&&this.plane&&(this.plane.visible=e.visible),e.width||e.height){const t=e.width||this.planeGeometry?.parameters.width,o=e.height||this.planeGeometry?.parameters.height;this.planeGeometry?.dispose(),this.planeGeometry=new g(t,o),this.plane&&(this.plane.geometry=this.planeGeometry)}if(e.transform&&this.plane?.matrix.set(e.transform.m11,e.transform.m21,e.transform.m31,e.transform.m41,e.transform.m12,e.transform.m22,e.transform.m32,e.transform.m42,e.transform.m13,e.transform.m23,e.transform.m33,e.transform.m43,e.transform.m14,e.transform.m24,e.transform.m34,e.transform.m44),e.data){if(!this.textureCtx)return;this.textureCtx.clearRect(0,0,this.textureCtx.canvas.width,this.textureCtx.canvas.height),e.data.currentFrame&&(e.data.currentFrame.draftImage?this.textureCtx.drawImage(e.data.currentFrame.draftImage,0,0):e.data.currentFrame.sourceImage&&this.textureCtx.drawImage(e.data.currentFrame.sourceImage,0,0),this.material?.map&&(this.material.map.needsUpdate=!0)),this.lastUpdatedFrame=e.data.currentFrame}}onDraw(e,t,o={}){this.lastUpdatedFrame!==t.data.currentFrame&&this.update({data:t.data})}onDetach(){this.planeGeometry?.dispose(),this.planeGeometry=void 0,this.plane&&a.Z.get("threejsScene")?.remove(this.plane),this.plane=void 0,this.material=void 0,this.textureCanvas=void 0,this.textureCtx=void 0,this.texture?.dispose(),this.texture=void 0,this.lastUpdatedFrame=void 0,this.stopWatchVisible?.(),this.stopWatchSize?.(),this.stopWatchTransform?.(),this.stopWatchData?.()}},text:class extends u{onUpdate(e){}onDraw(e,t,o={}){}},vector:u}}},75710:(e,t,o)=>{"use strict";o.d(t,{s8:()=>l,B3:()=>c,wN:()=>u,Kk:()=>d,pt:()=>p,R_:()=>m,ot:()=>h,K7:()=>g,_G:()=>f,Jn:()=>v,iU:()=>y,Bf:()=>w,_5:()=>b,Ie:()=>T,Bq:()=>k,Bi:()=>C,V7:()=>S,xH:()=>x,tu:()=>D});var a=o(29652),n=o(2262),i=o(67340),r=o(85002),s=o(48050);const l=(0,n.iH)("rectangle"),c=(0,n.iH)("add"),u=(0,n.iH)(!1),d=(0,n.iH)(null),p=(0,n.iH)(new DOMPoint),m=(0,n.iH)(null),h=(0,n.iH)(new DOMPoint),g=(0,n.iH)(null),f=(0,n.iH)(new DOMPoint),v=(0,n.iH)(1),y=(0,n.iH)([]),w=(0,a.Z)();function b(e=y.value){let t=1/0,o=-1/0,a=1/0,n=-1/0;for(const i of e)i.x<t&&(t=i.x),i.x>o&&(o=i.x),i.y<a&&(a=i.y),i.y>n&&(n=i.y),"quadraticBezierCurve"===i.type&&(i.shx<t&&(t=i.shx),i.shx>o&&(o=i.shx),i.shy<a&&(a=i.shy),i.shy>n&&(n=i.shy),i.ehx<t&&(t=i.ehx),i.ehx>o&&(o=i.ehx),i.ehy<a&&(a=i.ehy),i.ehy>n&&(n=i.ehy));return{left:t,right:o,top:a,bottom:n}}async function T(e=y.value){let t=v.value;if(e.length>0){const o=b(e),a=await D(o,e),n=await new Promise(((e,t)=>{try{a.toBlob((o=>{if(o){let a=new Image;a.onload=()=>{e(a),a=null},a.onerror=e=>{t(e),a=null},a.src=URL.createObjectURL(o)}else t(new Error("Canvas blob not created when drawing new selection shape."))}),"image/png",1)}catch(e){t(e)}}));m.value&&URL.revokeObjectURL(m.value.src),m.value=n,h.value.x=o.left-t,h.value.y=o.top-t}else m.value&&URL.revokeObjectURL(m.value.src),m.value=null,h.value.x=0,h.value.y=0}async function k(){v.value;let e=document.createElement("canvas");e.width=i.default.get("width"),e.height=i.default.get("height");let t=e.getContext("2d");if(!t)throw new Error("Couldn't draw to a new canvas when trying to apply selection mask.");t.imageSmoothingEnabled=!1,t.fillStyle="#000000",t.fillRect(0,0,e.width,e.height),t.globalCompositeOperation="destination-in",(0,r.j)(e,t,{selectedLayersOnly:!0}),g.value&&URL.revokeObjectURL(g.value.src),g.value=await(0,s.dJ)(e),f.value.x=0,f.value.y=0}function C(){g.value&&URL.revokeObjectURL(g.value.src),g.value=null,f.value.x=0,f.value.y=0}function S(){d.value&&URL.revokeObjectURL(d.value.src),d.value=null,p.value.x=0,p.value.y=0}function x(){m.value&&URL.revokeObjectURL(m.value.src),m.value=null,h.value.x=0,h.value.y=0}async function D(e,t=y.value){let o=v.value;null!=d.value?(p.value.x<e.left&&(e.left=p.value.x),p.value.y<e.top&&(e.top=p.value.y),p.value.x+d.value.width>e.right&&(e.right=p.value.x+d.value.width),p.value.y+d.value.height>e.bottom&&(e.bottom=p.value.y+d.value.height)):"subtract"===c.value&&(e.left=0,e.top=0,e.right=i.default.get("width"),e.bottom=i.default.get("height"));let a=document.createElement("canvas");a.width=e.right-e.left+2*o,a.height=e.bottom-e.top+2*o;let n=a.getContext("2d");if(!n)throw new Error("Couldn't draw to a new canvas when trying to apply selection mask.");n.imageSmoothingEnabled=!1,n.clearRect(0,0,a.width,a.height),n.fillStyle="#000000",null!=d.value&&n.drawImage(d.value,p.value.x-e.left+o,p.value.y-e.top+o),"subtract"===c.value?(d.value||n.fillRect(0,0,a.width,a.height),n.globalCompositeOperation="destination-out"):"intersect"===c.value&&(d.value||n.fillRect(0,0,a.width,a.height),n.globalCompositeOperation="destination-in"),n.beginPath();for(const a of t)"move"===a.type?n.moveTo(a.x-e.left+o,a.y-e.top+o):"line"===a.type?n.lineTo(a.x-e.left+o,a.y-e.top+o):"quadraticBezierCurve"===a.type&&n.bezierCurveTo(a.shx-e.left+o,a.shy-e.top+o,a.ehx-e.left+o,a.ehy-e.top+o,a.x-e.left+o,a.y-e.top+o);return n.closePath(),n.fill(),a}},37818:(e,t,o)=>{"use strict";o.d(t,{Gu:()=>a,$L:()=>n,kz:()=>i});const a=new WeakMap,n=Object.freeze({family:"Arial",size:16,weight:400,style:"normal",obliqueAngle:0,underline:null,underlineColor:null,underlineThickness:1,overline:null,overlineColor:null,overlineThickness:1,strikethrough:null,strikethroughColor:null,strikethroughThickness:1,fillColor:{is:"color",r:0,g:0,b:0,a:1,style:"#000000"},strokeColor:{is:"color",r:0,g:0,b:0,a:1,style:"#000000"},strokeSize:0,tracking:0,leading:0}),i=new Map;i.set("Arial",!0),i.set("Courier",!0),i.set("Impact",!0),i.set("Helvetica",!0),i.set("Monospace",!0),i.set("Tahoma",!0),i.set("Times New Roman",!0),i.set("Verdana",!0)},85101:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});var a=o(7043);const n=JSON.parse('{"empty":"","action":{"applyActiveSelection":"Apply Active Selection","clearSelection":"Clear Selection","convertLayersToImageSequence":"Convert Layers to Image Sequence","createNewFile":"New File","createNewLayersFromSelection":"Create Layers From Selection","cutLayers":"Cut Layer(s)","deleteLayers":"Delete Layer(s)","deleteLayerSelectionArea":"Delete Selection","fileTakePhoto":"Take a Photo","freeTransformRotate":"Free Transform (Rotate)","freeTransformScale":"Free Transform (Resize)","freeTransformTranslate":"Free Transform (Move)","insertLayer":"Insert Layer","moduleCropResize":"Crop and Resize","openFile":"Open File","pasteLayers":"Paste Layer(s)","reorderLayers":"Reorder Layer(s)","selectLayers":"Select Layer(s)","toggleLayerVisibilityOn":"Toggle Layer Visibility On","toggleLayerVisibilityOff":"Toggle Layer Visibility Off","updateActiveSelection":"Update Active Selection","updateFile":"Update File","updateLayer":"Update Layer","updateSelectionCombineMode":"Update Selection Combine Mode"},"app":{"colorPickerGradient":{"hueSlider":"Hue Slider","opacitySlider":"Opacity Slider"},"dndDropOverlay":{"addImage":"Add Image"},"layerList":{"toggleLayerVisibility":"Toggle Layer Visibility","layerSettings":"Layer Settings","delete":"Delete","frames":"Frames","playAnimation":"Play Animation","stopAnimation":"Stop Animation","editFrames":"Edit Frames","emptyGroup":"Group is Empty."},"wait":{"loadingImage":"Loading Image","pleaseWait":"Please Wait","cancel":"Cancel"}},"button":{"apply":"Apply","cancel":"Cancel","clear":"Clear","convert":"Convert","create":"Create","createNewImage":"Create New Image","done":"Done","export":"Export","no":"No","ok":"OK","openImage":"Open Image","save":"Save","settings":"Settings","take":"Take","takePhoto":"Take Photo","yes":"Yes"},"canvas":{"toolbar":{"cropResize":{"waitLabel":"Crop and Resize"}}},"dock":{"colorPicker":{"title":"Color Picker","pickColorFromImage":"Pick Color From Image","hexCode":"Hex Code"},"layers":{"title":"Layers","add":"Add","layer":"Layer","group":"Group","background":"Background","toggleBackgroundVisibility":"Toggle Background Visibility","noLayers":"No Layers Yet."},"settings":{"title":"Actions","file":{"tabTitle":"File","menu":{"new":"New","open":"Open","export":"Export","saveAs":"Save As","insertPhoto":"Insert a Photo","takePhoto":"Take a Photo"}},"image":{"tabTitle":"Image","menu":{"cropResize":"Crop and Resize","convertLayers":{"groupTitle":"Convert Layers...","toImageSequence":"To Image Sequence"},"cut":"Cut","copy":"Copy","copyAllLayers":"Copy All Layers","paste":"Paste"}},"view":{"tabTitle":"View","zoom":"Zoom","zoomOut":"Zoom Out","zoomIn":"Zoom In","rotate":"Rotate","rotateCounterClockwise":"Rotate Counterclockwise","rotateClockwise":"Rotate Clockwise","reset":"Reset","fit":"Fit","touchRotate":{"label":"Touch Rotate","on":"On","snap":"Snap","off":"Off"}},"history":{"tabTitle":"History","undo":"Undo","redo":"Redo","noHistory":"No History Yet.","baseImage":"Base Image"},"prefs":{"tabTitle":"Prefs","theme":"Theme","performance":{"groupTitle":"Performance","renderer":{"label":"Renderer","2d":"Canvas 2D","webgl":"WebGL"},"optimizeLargeImage":"Optimize for Large Image","highQualityScaling":"High Quality Scaling","fixAdjacentLayerSeams":"Fix Adjacent Layer Seams"},"editor":{"groupTitle":"Editor","menuBarPosition":"Menu Bar Position","showWelcomeScreen":"Show Welcome Screen","showTips":"Show Tips","resetSettings":"Reset Settings"}}}},"el":{"horizontalScrollbarArrows":{"scrollLeft":"Scroll Left","scrollRight":"Scroll Right"}},"keyboardMap":{"file":{"name":"File","actions":{"open":"Open File","quickLoad":"Quick Load","quickSave":"Quick Save"}},"image":{"name":"Image","actions":{"cut":"Cut","copy":"Copy","paste":"Paste"}},"history":{"name":"Editing History","actions":{"undo":"Undo","redo":"Redo"}},"selection":{"name":"Selection","actions":{"selectAll":"Select All"}}},"layoutShortcutGroup":{"color":{"name":"Pick Color","controls":{"default":{"label":"Pick Color"}}},"deform":{"name":"Deform","controls":{"default":{"label":"Deform"}}},"draw":{"name":"Draw","controls":{"default":{"label":"Draw"}}},"effects":{"name":"Effects","controls":{"default":{"label":"Effects"}}},"erase":{"name":"Erase","controls":{"default":{"label":"Erase"}}},"history":{"name":"History","controls":{"undo":{"label":"Undo"},"redo":{"label":"Redo"}}},"layers":{"name":"Layers","controls":{"default":{"label":"Layers"}}},"search":{"name":"Search","controls":{"default":{"label":"Search"}}},"selection":{"name":"Selection","controls":{"default":{"label":"Selection"}}},"settings":{"name":"Actions","controls":{"default":{"label":"Actions"}}},"text":{"name":"Text","controls":{"default":{"label":"Insert / Edit Text"}}},"transform":{"name":"Move / Transform","controls":{"default":{"label":"Move / Transform"}}},"view":{"name":"Canvas Viewport","controls":{"default":{"label":"Zoom / Pan View"}}}},"lib":{"tutorial":{"notification":{"gotIt":"Got It","dontShowTips":"Don\'t Show Tips"}}},"measurement":{"pixels":"Pixels","millimeters":"Millimeters","centimeters":"Centimeters","inches":"Inches","pixelsPerInch":"Pixels/Inch","pixelsPerMillimeter":"Pixels/Millimeter","pixelsPerCentimeter":"Pixels/Centimeter"},"menuBar":{"toolsHeading":"Tools"},"module":{"fileExport":{"title":"Export Image","saveBackIntroduction":"You have opened a file named {fileName}.","saveBackQuestion":"Save back to the original file?","fileName":"File Name","fileType":"File Type","layers":"Layers","quality":"Quality","dithering":"Dithering","ditheringOption":{"none":"None","atkinson":"Atkinson","atkinsonSerpentine":"Atkinson (serpentine)","floydSteinberg":"Floyd Steinberg","floydSteinbergSerpentine":"Floyd Steinberg (serpentine)","falseFloydSteinberg":"False Floyd Steinberg","falseFloydSteinbergSerpentine":"False Floyd Steinberg (serpentine)","stucki":"Stucki","stuckiSerpentine":"Stucki (serpentine)"}},"fileNew":{"title":"New Image","preset":"Preset","presetPlaceholder":"Select (Optional)","width":"Width","height":"Height","resolution":"Resolution","colorProfile":"Color Profile","scaleFactor":"Scale Factor"},"fileSaveAs":{"title":"Save Image As","saveBackIntroduction":"You have opened a file named {fileName}.","saveBackQuestion":"Save back to the original file?","exportDisclaimer":"If you wish to share or view the image in other programs, use \\"Export\\" instead.","fileName":"File Name"},"fileTakePhoto":{"title":"Take Photo","noCameraError":{"title":"Camera Unavailable","message":"Either the device has no cameras or access to the camera was declined."},"selectCamera":{"placeholder":"Select Camera","user":"Front (User)","environment":"Rear (Environment)"}},"imageConvertLayersToImageSequence":{"title":"Convert Layers to Image Sequence","frameDelay":"Frame Delay"}},"moduleGroup":{"file":{"name":"File Management","description":"Load and save images to your device.","modules":{"export":{"name":"Export Image","description":"Save the image in a universal format that can be opened by other editors."},"insertPhoto":{"name":"Insert a Photo","description":"Add a photo as a new layer in the currently opened image."},"new":{"name":"New Image","description":"Create a new image with specified dimensions."},"open":{"name":"Open Image","description":"Open an image or project file in a new workspace."},"quickLoad":{"name":"Quick Load","description":"Load the file saved by quick save."},"quickSave":{"name":"Quick Save","description":"Saves the current file to temporary storage."},"saveAs":{"name":"Save Image As","description":"Saves the image in a project format that can be re-opened by OpenGraphica without losing any information."},"takePhoto":{"name":"Take a Photo","description":"Take a photo from your camera and webcam and insert it into the image."}}},"history":{"name":"Editing History","description":"Operations that control moving through the history of image edits.","modules":{"redo":{"name":"History Redo","description":"Redo the last undone action."},"undo":{"name":"History Undo","description":"Undo the last action."}}},"image":{"name":"Image Canvas","description":"Operations that affect the image canvas.","modules":{"convertLayersToImageSequence":{"name":"Convert Layers to Image Sequence","description":"Converts the selected layers to an image sequence layer (animation)."},"copy":{"name":"Copy Selected Layers","description":"Copy the currently selected layers to the clipboard."},"copyAll":{"name":"Copy All Layers","description":"Copy all layers on the canvas as a PNG image to the clipboard."},"cut":{"name":"Cut","description":"Remove the currently selected layers and copy them to the clipboard."},"paste":{"name":"Paste","description":"Insert images on to the canvas from the clipboard."}}},"tmp":{"name":"Temporary Modules","description":"Modules that will only stick around during initial development.","modules":{"notYetImplemented":{"name":"Not Yet Implemented","description":"Show a warning."}}},"tutorial":{"name":"Tutorials","description":"Learn how to use OpenGraphica.","modules":{"welcome":{"name":"Welcome","description":"Start working on an image."}}}},"option":{"bottom":"Bottom","left":"Left","right":"Right","top":"Top"},"theme":{"light":"Light","dark":"Dark"},"toolbar":{"cropResize":{"title":"Crop and Resize","linkWidthHeight":"Link Width/Height","width":"Width","height":"Height","dimensionUnits":"Dimension Units","resolution":"Resolution","resolutionUnits":"Resolution Units","snapping":"Snapping"},"freeTransform":{"clearSelection":"Clear Selection","pickLayer":{"label":"Pick Layer","auto":"Auto","current":"Current"},"snapping":{"title":"Snapping","rotationSnap":"Rotation Snap"},"metrics":{"title":"Metrics","position":"Position","width":"Width","height":"Height","rotation":"Rotation","resetRotation":"Reset Rotation","noLayers":"No layer(s) selected."}},"general":{"settings":"Settings"},"selection":{"selectionShape":{"label":"Selection Shape","rectangle":"Rectangle","ellipse":"Ellipse","free":"Free","tonalArea":"Tonal Area"},"selectionCombineMode":{"label":"Selection Combine Mode","add":"Add","subtract":"Subtract","intersect":"Intersect"}},"text":{"font":"Font","size":"Size","bold":"Bold","italic":"Italic","strikethrough":"Strikethrough","underline":"Underline","fill":"Fill","fillTooltip":"Color that shows inside the edges of the letter(s)"},"zoom":{"zoomOut":"Zoom Out","zoomIn":"Zoom In","rotateCounterClockwise":"Rotate Counterclockwise","rotateClockwise":"Rotate Clockwise","fit":"Fit","flip":"Flip"}},"toolGroup":{"draw":{"name":"Draw","description":"Brushes, pencils, pens, and vector art drawing tools.","tools":{"brush":{"name":"Brush","description":"Brushes that draw on raster layers."}}},"image":{"name":"Image","description":"General image resolution manipulation.","tools":{"cropResize":{"name":"Crop and Resize","description":"Crop, resize, change aspect ratio, or resample the image."}}},"selection":{"name":"Selection","description":"Select areas of the active layer(s), any manipulations to the layer(s) only occur inside the selection.","tools":{"selection":{"name":"Selection","description":"Select an area of the image for targeted editing."}}},"text":{"name":"Text","description":"Tools for manipulating text layers.","tools":{"text":{"name":"Text","description":"Create and edit text layers."}}},"transform":{"name":"Transform","description":"Tools for moving, rotating, scaling the layer.","tools":{"freeTransform":{"name":"Free Transform","description":"Move, rotate, or scale the selected layers."}}},"view":{"name":"Viewport Display","description":"Tools for controlling the viewport display of the canvas.","tools":{"name":"Zoom","description":"Zoom in and out the canvas to control how much of the image you can see."}}}}'),i=(0,a.o)({locale:"en",fallbackLocale:"en",messages:{en:n}})},85002:(e,t,o)=>{"use strict";o.d(t,{j:()=>c,d:()=>u});var a=o(91648),n=o(22053),i=o(67340),r=o(2521);const s=n.Z.get("imageSmoothingZoomRatio"),l={grabbing:{data:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-move" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10zM.146 8.354a.5.5 0 0 1 0-.708l2-2a.5.5 0 1 1 .708.708L1.707 7.5H5.5a.5.5 0 0 1 0 1H1.707l1.147 1.146a.5.5 0 0 1-.708.708l-2-2zM10 8a.5.5 0 0 1 .5-.5h3.793l-1.147-1.146a.5.5 0 0 1 .708-.708l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L14.293 8.5H10.5A.5.5 0 0 1 10 8z"/></svg>',image:null,offsetX:-8,offsetY:-8}};function c(e,t,o={}){o.force2dRenderer=!0;let n=performance.now();t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),o.initialTransform&&t.transform(o.initialTransform.a,o.initialTransform.b,o.initialTransform.c,o.initialTransform.d,o.initialTransform.e,o.initialTransform.f);const l=a.Z.get("transform"),c=a.Z.get("decomposedTransform"),u=a.Z.get("useCssViewport");u||o.selectionTest||t.transform(l.a,l.b,l.c,l.d,l.e,l.f),t.imageSmoothingEnabled=c.scaleX/window.devicePixelRatio<s,window.averageTimeStart=.1*(performance.now()-n)+.9*(window.averageTimeStart||0),n=performance.now();const d=i.default.get("background"),p=i.default.get("width"),m=i.default.get("height");t.beginPath();const h=2/c.scaleX,g=p,f=m;if(t.rect(0,0,g-0,f-0),u||(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=a.Z.get("workingImageBorderColor"),t.shadowBlur=20*c.scaleX),t.lineWidth=h,t.fillStyle=d.visible?d.color.style:"transparent",t.fill(),t.shadowBlur=0,o.selectionTest){const e=t.getImageData(o.selectionTest.point.x,o.selectionTest.point.y,1,1);o.selectionTest.resultPixelTest=e.data.slice(0,4)}window.averageTimeCanvas=.1*(performance.now()-n)+.9*(window.averageTimeCanvas||0),n=performance.now(),u||(t.save(),t.beginPath(),t.rect(0,0,p,m),t.clip()),window.averageTimeClip=.1*(performance.now()-n)+.9*(window.averageTimeClip||0),n=performance.now();const v=i.default.get("layers");for(const e of v)o.force2dRenderer?(new r.default["2d"][e.type]).draw(t,e,o):e.renderer.draw(t,e,o);window.averageTimeLayers=.1*(performance.now()-n)+.9*(window.averageTimeLayers||0),n=performance.now(),a.Z.get("isBufferInUse")&&(a.Z.set("isBufferInUse",!1),t.drawImage(a.Z.get("bufferCanvas"),0,0)),u||t.restore(),window.averageTimeRestore=.1*(performance.now()-n)+.9*(window.averageTimeRestore||0),n=performance.now(),window.averageTime=.1*(performance.now()-n)+.9*(window.averageTime||0)}function u(e,t,o,a={}){e.render(t,o)}(()=>{for(const e in l){const t=l[e],o=new Image,a=new Blob([t.data],{type:"image/svg+xml"}),n=URL.createObjectURL(a);o.src=n,t.image=o}})()},40139:(e,t,o)=>{"use strict";function a(e){return null!=e.r?"rgba":null!=e.c?"cmyka":null!=e.v?"hsva":null!=e.l?"hsla":"rgba"}function n(e){var t=e.toString(16);return 1==t.length?"0"+t:t}function i(e,t,o){return e.style=r(e,t),e.style}function r(e,t){let o=e;return"rgba"!==t&&(o=c(e,t)),("#"+n(Math.round(255*o.r))+n(Math.round(255*o.g))+n(Math.round(255*o.b))+(o.a<1?n(Math.round(255*o.a)):"")).toUpperCase()}function s(e,t){let o=(e=e.replace("#","")).length<6?e.substring(0,1)+e.substring(0,1):e.substring(0,2),a=e.length<6?e.substring(1,2)+e.substring(1,2):e.substring(2,4),n=e.length<6?e.substring(2,3)+e.substring(2,3):e.substring(4,6),i=e.length<6?e.substring(3,4)+e.substring(3,4):e.substring(6,8),r=d("rgba",{r:parseInt(o,16)/255,g:parseInt(a,16)/255,b:parseInt(n,16)/255,a:parseInt(i,16)/255});return isNaN(r.r)&&(r.r=0),isNaN(r.g)&&(r.g=0),isNaN(r.b)&&(r.b=0),isNaN(r.a)&&(r.a=1),p(r,t)}function l(e,t,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+6*(t-e)*o:o<.5?t:o<2/3?e+(t-e)*(2/3-o)*6:e}function c(e,t){if("hsla"===t){const{h:t,s:o,l:a,a:n,style:i}=e;let r,s,c;if(0==o)r=s=c=a;else{let e=a<.5?a*(1+o):a+o-a*o,n=2*a-e;r=l(n,e,t+1/3),s=l(n,e,t),c=l(n,e,t-1/3)}return{is:"color",r,g:s,b:c,a:n,style:i}}if("hsva"===t){const{h:t,s:o,v:a,a:n,style:i}=e;let r=0,s=0,l=0;const c=Math.floor(6*t),u=6*t-c,d=a*(1-o),p=a*(1-u*o),m=a*(1-(1-u)*o);switch(c%6){case 0:r=a,s=m,l=d;break;case 1:r=p,s=a,l=d;break;case 2:r=d,s=a,l=m;break;case 3:r=d,s=p,l=a;break;case 4:r=m,s=d,l=a;break;case 5:r=a,s=d,l=p}return{is:"color",r,g:s,b:l,a:n,style:i}}return e}function u(e,t){if("hsla"===t){const{h:t,s:o,l:a,a:n,style:i}=e;let r=o*(a<.5?a:1-a);return{is:"color",h:t,s:2*r/Math.max(1e-8,a+r),v:a+r,a:n,style:i}}if("rgba"===t){const{r:t,g:o,b:a,a:n,style:i}=e,r=Math.max(t,o,a),s=Math.min(t,o,a);let l=0,c=0,u=r;const d=r-s;if(c=0==r?0:d/r,r==s)l=0;else{switch(r){case t:l=(o-a)/d+(o<a?6:0);break;case o:l=(a-t)/d+2;break;case a:l=(t-o)/d+4}l/=6}return{is:"color",h:l,s:c,v:u,a:n,style:i}}return e}function d(e,t,o){const a={is:"color",...t};return i(a,e),a}function p(e,t){const o=a(e);return"hsla"===t?function(e,t){if("hsva"===t){const{h:t,s:o,v:a,a:n,style:i}=e;let r;return{is:"color",h:t,s:o*a/Math.max(1e-8,(r=(2-o)*a)<1?r:2-r),l:t/2,a:n,style:i}}if("rgba"===t){const{r:t,g:o,b:a,a:n,style:i}=e,r=Math.max(t,o,a),s=Math.min(t,o,a);let l=0,c=0,u=(r+s)/2;if(r==s)l=c=0;else{const e=r-s;switch(c=u>.5?e/(2-r-s):e/(r+s),r){case t:l=(o-a)/e+(o<a?6:0);break;case o:l=(a-t)/e+2;break;case a:l=(t-o)/e+4}l/=6}return{is:"color",h:l,s:c,l:u,a:n,style:i}}return e}(e,o):"hsva"===t?u(e,o):"rgba"===t?c(e,o):e}o.d(t,{VT:()=>a,nq:()=>i,hq:()=>r,uG:()=>s,cp:()=>c,j_:()=>u,LF:()=>d,Re:()=>p})},87521:(e,t,o)=>{"use strict";function a(e){let t,o,a,n=e.a,i=e.b,r=e.c,s=e.d,l=e.e,c=e.f;return(t=Math.sqrt(n*n+i*i))&&(n/=t,i/=t),(a=n*r+i*s)&&(r-=n*a,s-=i*a),(o=Math.sqrt(r*r+s*s))&&(r/=o,s/=o,a/=o),n*s<i*r&&(n=-n,i=-i,a=-a,t=-t),{translateX:l,translateY:c,rotation:Math.atan2(i,n),skewX:Math.atan(a),scaleX:t,scaleY:o}}o.d(t,{cV:()=>a})},95452:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});const a=(0,o(29652).Z)(),n=new class{on(e,t){return a.on(e,t)}off(e,t){return a.off(e,t)}emit(e,t){return a.emit(e,t)}}},84710:(e,t,o)=>{"use strict";function a(e){return!!e&&("text"==e.type||"INPUT"==e.tagName||"textarea"==e.type)}o.d(t,{u7:()=>a,Sf:()=>i,iZ:()=>r});class n{constructor(e){for(let t in e)this[t]=e[t]}}function i(e,t){return new n({altKey:t.altKey,altitudeAngle:1.5707963267948966,azimuthAngle:0,bubbles:t.bubbles,button:t.button,buttons:t.buttons,cancelBubble:t.cancelBubble,cancelable:t.cancelable,clientX:t.clientX,clientY:t.clientY,composed:t.composed,ctrlKey:t.ctrlKey,currentTarget:t.currentTarget,defaultPrevented:t.defaultPrevented,detail:t.detail,eventPhase:t.eventPhase,fromElement:null,height:23,isPrimary:!0,isTrusted:t.isTrusted,layerX:t.pageX,layerY:t.pageY,metaKey:t.metaKey,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:t.pageX,pageY:t.pageY,pointerId:0,pointerType:"mouse",pressure:1,relatedTarget:null,returnValue:t.returnValue,screenX:t.screenX,screenY:t.screenY,shiftKey:t.shiftKey,srcElement:t.srcElement,tangentialPressure:0,target:t.target,tiltX:0,tiltY:0,timeStamp:t.timeStamp,toElement:null,twist:0,type:e,view:t.view,which:1,width:23,x:t.clientX,y:t.clientY})}function r(e,t){const o=[];for(let a=0;a<t.changedTouches.length;a++){const i=t.changedTouches[a];o.push(new n({altKey:t.altKey,altitudeAngle:1.5707963267948966,azimuthAngle:0,bubbles:t.bubbles,button:0,buttons:1,cancelBubble:t.cancelBubble,cancelable:t.cancelable,clientX:i.clientX,clientY:i.clientY,composed:t.composed,ctrlKey:t.ctrlKey,currentTarget:t.currentTarget,defaultPrevented:t.defaultPrevented,detail:t.detail,eventPhase:t.eventPhase,fromElement:null,height:23,isPrimary:t.touches[0]&&t.touches[0].identifier===i.identifier||0===t.touches.length,isTrusted:t.isTrusted,layerX:i.pageX,layerY:i.pageY,metaKey:t.metaKey,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:i.pageX,pageY:i.pageY,pointerId:i.identifier,pointerType:"touch",pressure:1,relatedTarget:null,returnValue:t.returnValue,screenX:i.screenX,screenY:i.screenY,shiftKey:t.shiftKey,srcElement:t.srcElement,tangentialPressure:0,target:t.target,tiltX:0,tiltY:0,timeStamp:t.timeStamp,toElement:null,twist:0,type:e,view:t.view,which:1,width:23,x:i.clientX,y:i.clientY}))}return o}},52294:(e,t,o)=>{"use strict";o.d(t,{Y:()=>i});var a=o(48050);let n;async function i(e){let t="";const o=await(0,a.pm)(e);n||(n=document.createElement("canvas")),n.width=20,n.height=20/o.width*o.height;const i=n.getContext("2d");if(i){i.clearRect(0,0,n.width,n.height),i.scale(20/o.width,20/o.width),i.drawImage(o,0,0);const e=await crypto.subtle.digest("SHA-1",i.getImageData(0,0,n.width,n.height).data),a=new Uint8Array(e);t=n.width+"x"+n.height+"x"+Array.prototype.map.call(a,(e=>("00"+e.toString(16)).slice(-2))).join("")}return t}},48050:(e,t,o)=>{"use strict";function a(e){let t=document.createElement("canvas");t.width=e.width,t.height=e.height;let o=t.getContext("2d");if(!o)return t=null,new ImageData(e.width,e.height);o.drawImage(e,0,0);const a=o.getImageData(0,0,e.width,e.height);return t=null,o=null,a}function n(e,t={}){const o=t.emptyColor||null;if(o)for(const[e,t]of o.entries())o[e]=Math.round(255*t);const a=null==t.emptyColorTolerance?0:Math.round(255*t.emptyColorTolerance),n=null==t.alphaTolerance?0:Math.round(255*t.alphaTolerance),i={left:0,right:0,top:0,bottom:0},{data:r,width:s,height:l}=e;e:for(let e=0;e<l;e++)for(let t=0;t<s;t++){const l=e*(4*s)+4*t;if(!(r[l+3]<=n||null!=o&&Math.abs(r[l]-o[l])<=a&&Math.abs(r[l+1]-o[l+1])<=a&&Math.abs(r[l+2]-o[l+2])<=a)){i.top=e;break e}}e:for(let e=l-1;e>=0;e--)for(let t=s-1;t>=0;t--){const l=e*(4*s)+4*t;if(!(r[l+3]<=n||null!=o&&Math.abs(r[l]-o[l])<=a&&Math.abs(r[l+1]-o[l+1])<=a&&Math.abs(r[l+2]-o[l+2])<=a)){i.bottom=e+1;break e}}e:for(let e=0;e<s;e++)for(let t=0;t<l;t++){const l=t*(4*s)+4*e;if(!(r[l+3]<=n||null!=o&&Math.abs(r[l]-o[l])<=a&&Math.abs(r[l+1]-o[l+1])<=a&&Math.abs(r[l+2]-o[l+2])<=a)){i.left=e;break e}}e:for(let e=s-1;e>=0;e--)for(let t=l-1;t>=0;t--){const l=t*(4*s)+4*e;if(!(r[l+3]<=n||null!=o&&Math.abs(r[l]-o[l])<=a&&Math.abs(r[l+1]-o[l+1])<=a&&Math.abs(r[l+2]-o[l+2])<=a)){i.right=e+1;break e}}return i}async function i(e,t={}){return await new Promise(((o,a)=>{e.toBlob((async e=>{if(e)try{o(await r(e,t))}catch(e){a(e)}else a(new Error("Canvas blob not created when drawing new selection shape."))}),"image/png",1)}))}function r(e,t={}){return new Promise((async(o,a)=>{let n=new Image;n.onload=()=>{o(n),n=null},n.onerror=e=>{a(e),n=null},"dataUrl"===t.srcType?n.src=await new Promise(((t,o)=>{const a=new FileReader;a.onload=e=>{t(e.target?.result)},a.onerror=e=>{o(e)},a.readAsDataURL(e)})):n.src=URL.createObjectURL(e)}))}o.d(t,{p7:()=>a,_7:()=>n,dJ:()=>i,pm:()=>r})},10177:(e,t,o)=>{"use strict";o.d(t,{vc:()=>p,G5:()=>m});const a=JSON.parse('[{"name":"keyboardMap.file.name","actions":[{"name":"keyboardMap.file.actions.open","action":{"type":"runModule","target":"file/open"},"shortcuts":["ctrl+o"]},{"name":"keyboardMap.file.actions.quickSave","action":{"type":"runModule","target":"file/quickSave"},"shortcuts":["ctrl+alt+s"]},{"name":"keyboardMap.file.actions.quickLoad","action":{"type":"runModule","target":"file/quickLoad"},"shortcuts":["ctrl+alt+o"]}]},{"name":"keyboardMap.image.name","actions":[{"name":"keyboardMap.image.actions.copy","action":{"type":"runModule","target":"image/copy"},"shortcuts":["ctrl+c"]},{"name":"keyboardMap.image.actions.cut","action":{"type":"runModule","target":"image/cut"},"shortcuts":["ctrl+x"]}]},{"name":"keyboardMap.history.name","actions":[{"name":"keyboardMap.history.actions.undo","action":{"type":"runModule","target":"history/undo"},"shortcuts":["ctrl+z"]},{"name":"keyboardMap.history.actions.redo","action":{"type":"runModule","target":"history/redo"},"shortcuts":["ctrl+y","ctrl+shift+z"]}]},{"name":"keyboardMap.selection.name","actions":[{"name":"keyboardMap.selection.actions.selectAll","action":{"type":"appEmit","target":"editor.tool.selectAll"},"shortcuts":["ctrl+a"]}]}]');var n=o(2262),i=o(19971),r=o(95452),s=o(84710),l=o(52294),c=o(9723);const u=(0,n.iH)(!1),d=(0,n.iH)(!1),p=(0,n.iH)(!1),m=(0,n.iH)(!1),h=(0,n.iH)(!1),g=(0,n.iH)(!1),f=new Map;!function(e){for(const t of e)for(const e of t.actions)for(const t of e.shortcuts){const o=t.split(/[\+ ]+/);let a="",n=!1,i=!1,r=!1;for(const e of o)"shift"===e?n=!0:"ctrl"===e?i=!0:"alt"===e?r=!0:a=e;let s=f.get(a)||[];s.push({alt:r,ctrl:i,shift:n,action:e.action}),f.set(a,s)}}(a);let v=!1;document.addEventListener("keydown",(function(e){if("Control"===e.key)u.value=!0,p.value=!0,g.value=!0;else if("Meta"===e.key)d.value=!0,p.value=!0,g.value=!0;else if("Shift"===e.key)m.value=!0,g.value=!0;else if("Alt"===e.key)h.value=!0,g.value=!0;else if("Escape"===e.key)r.Z.emit("editor.tool.cancelCurrentAction");else if("Enter"===e.key)r.Z.emit("editor.tool.commitCurrentAction");else if(!0===g.value){if((0,s.u7)(e.target))return;const t=f.get(e.key.toLowerCase());if(t)for(const o of t)if(o.alt===h.value&&o.ctrl===p.value&&o.shift===m.value){if(e.preventDefault(),"toolGroup"===o.action.type);else if("dock"===o.action.type)r.Z.emit("app.dialogs.openFromDock",{name:o.action.target});else if("runModule"===o.action.type){const e=o.action.target.split("/");(0,c.Mz)(e[0],e[1])}else"appEmit"===o.action.type&&r.Z.emit(o.action.target);break}}}),!0),document.addEventListener("keyup",(function(e){"Control"===e.key?u.value=!1:"Meta"===e.key?d.value=!1:"Shift"===e.key?m.value=!1:"Alt"===e.key&&(h.value=!1),u.value||d.value||(p.value=!1),u.value||d.value||m.value||h.value||(g.value=!1)}),!0),document.addEventListener("paste",(async function(e){if(!(0,s.u7)(e.target)&&!v&&e.clipboardData){const t=e.clipboardData.items;if(t){for(let e=0;e<t.length;e++){const a=t[e];if(-1!==a.type.indexOf("image")){const e=a.getAsFile();if(e){r.Z.emit("app.wait.startBlocking",{id:"documentPasteImage",label:"app.wait.loadingImage"}),v=!0;let t=!0;if(i.default.state.hasClipboardUpdateSupport){const o=await(0,l.Y)(e);t=i.default.state.clipboardBufferImageHash!==o}else t=e.lastModified>i.default.state.clipboardBufferUpdateTimestamp;if(t){const{openFromFileList:t}=await Promise.all([o.e(8107),o.e(8341),o.e(8658)]).then(o.bind(o,24786));await t([e],{insert:!0})}else{const{pasteFromEditorCopyBuffer:e}=await Promise.all([o.e(4736),o.e(8107),o.e(2677)]).then(o.bind(o,23233));await e()}v=!1,r.Z.emit("app.wait.stopBlocking",{id:"documentPasteImage"}),r.Z.emit("app.workingFile.notifyImageLoadedFromClipboard")}}}e.preventDefault()}}}),!1)},78835:(e,t,o)=>{"use strict";function a(e,t,o){return(1-o)*e+o*t}function n(e,t,o,a){const n=o-e,i=a-t;return Math.sqrt(n*n+i*i)}o.d(t,{t:()=>a,y:()=>n})},63063:(e,t,o)=>{"use strict";function a(e,t,o,n,i){return"px"===t?"mm"===o?("px/mm"!==i&&("px/in"===i&&(n*=1/25.4),"px/cm"===i&&(n*=10)),e/=n):"cm"===o?("px/cm"!==i&&("px/in"===i&&(n*=1/2.54),"px/mm"===i&&(n*=.1)),e/=n):"in"===o&&("px/in"!==i&&("px/cm"===i&&(n*=2.54),"px/mm"===i&&(n*=25.4)),e/=n):"px"===o?"mm"===t?("px/mm"!==i&&("px/in"===i&&(n*=1/25.4),"px/cm"===i&&(n*=10)),e*=n):"cm"===t?("px/cm"!==i&&("px/in"===i&&(n*=1/2.54),"px/mm"===i&&(n*=.1)),e*=n):"in"===t&&("px/in"!==i&&("px/cm"===i&&(n*=2.54),"px/mm"===i&&(n*=25.4)),e*=n):e=a(a(e,t,"px",n,i),"px",o,n,i),e}o.d(t,{L3:()=>a,Uf:()=>r});class n{static kerningTestCanvas;static kerningTestCtx;fontFamily;pxSize;baseline;kerningMap=new Map;testWidth=0;offsetHeight=0;constructor(e,t){this.fontFamily=e,this.pxSize=t;const o=document.createElement("div"),a=document.body;o.style.position="absolute",o.style.whiteSpace="nowrap",o.style.font=this.pxSize+"px "+e,a.appendChild(o);const n="";o.innerHTML=n,this.testWidth=o.offsetWidth/n.length,this.offsetHeight=o.offsetHeight;const i=document.createElement("span");i.style.display="inline-block",i.style.overflow="hidden",i.style.width="1px",i.style.height="1px",o.appendChild(i),this.baseline=i.offsetTop+i.offsetHeight,document.body.removeChild(o)}getKerningTestCanvas(){if(!n.kerningTestCanvas){n.kerningTestCanvas=document.createElement("canvas"),n.kerningTestCanvas.width=10,n.kerningTestCanvas.height=10,n.kerningTestCanvas.setAttribute("style","font-kerning: normal; text-rendering: optimizeLegibility;");try{n.kerningTestCtx=n.kerningTestCanvas.getContext("2d")}catch(e){}}return{canvas:n.kerningTestCanvas,ctx:n.kerningTestCtx}}calculateLetterBounds(e,t){const{canvas:o,ctx:a}=this.getKerningTestCanvas();let n=0,i=0;if(o&&a){t=t||"alphabetic",o.width=this.testWidth,o.height=this.offsetHeight,a.clearRect(0,0,this.testWidth,this.offsetHeight),a.font=" "+this.pxSize+"px "+this.fontFamily,a.textAlign="left",a.textBaseline=t,a.fillStyle="#000000",a.fillText(e,0,"alphabetic"===t?this.baseline:0);const r=a.getImageData(0,0,this.testWidth,this.offsetHeight).data,s=r.length;n=0,i=this.offsetHeight;for(let e=0;e<s;e+=4)if(0!==r[e+3]){n=Math.floor(e/4/this.testWidth);break}for(let e=s-4;e>=0;e-=4)if(0!==r[e+3]){i=Math.floor(e/4/this.testWidth);break}o.width=10,o.height=10}return{top:n,bottom:i,height:i-n}}getKerningOffset(e,t={}){let o=this.kerningMap.get(e);if(null==o){const{ctx:a}=this.getKerningTestCanvas();a&&(a.font=" "+(t.style?t.style:"normal")+" "+(t.weight?t.weight:"")+" "+this.pxSize+"px "+this.fontFamily,o=a.measureText(e).width-(a.measureText(e[0]).width+a.measureText(e[1]).width),this.kerningMap.set(e,o))}return o}}const i=new Map;function r(e,t,o=!1){let a=i.get(e+"_"+t);return a||(a=new n(e,t),o||i.set(e+"_"+t,a)),a}},91457:(e,t,o)=>{"use strict";o.d(t,{$b:()=>n,Rl:()=>i,Ol:()=>r,v7:()=>s});var a=o(66252);function n(e){return i((0,a.f3)(e))}function i(e){const t=t=>{const o=e(t),a=document.querySelectorAll("body > .el-notification");return a.length>0&&document.querySelector(".opengraphica").appendChild(a[a.length-1]),o};return t.closeAll=()=>e.closeAll(),t.success=function(){return e.success(...arguments)},t.warning=function(){return e.warning(...arguments)},t.error=function(){return e.error(...arguments)},t.info=function(){return e.info(...arguments)},t}const r='An unexpected error occurred. If this error persists, please <a href="https://github.com/opengraphica/opengraphica/issues/new" target="_blank">report an issue on Github</a>.',s="Please correct the error messages shown in the form before submitting."},75720:(e,t,o)=>{"use strict";function a(e,t,o){var a,n,i,r=null,s=0;o||(o={});var l=function(){s=!1===o.leading?0:Date.now(),r=null,i=e.apply(a,n),r||(a=n=null)};return function(){var c=Date.now();s||!1!==o.leading||(s=c);var u=t-(c-s);return a=this,n=arguments,u<=0||u>t?(r&&(clearTimeout(r),r=null),s=c,i=e.apply(a,n),r||(a=n=null)):r||!1===o.trailing||(r=window.setTimeout(l,u)),i}}o.d(t,{P:()=>a,X:()=>n});class n{queue=[];isCallbacksRunning=!1;push(e){this.queue.push(e),this.isCallbacksRunning||this.runCallbacks()}async runCallbacks(){for(this.isCallbacksRunning=!0;this.queue.length>0;){const e=this.queue.shift();if(e)try{await e()}catch(e){console.error(e)}}this.isCallbacksRunning=!1}}},28398:(e,t,o)=>{"use strict";o.d(t,{Z:()=>qe});var a=o(49963),n=o(85101),i=(o(90379),o(87497),o(66252)),r=o(3577),s=o(2262);const l={ref:"canvasArea",class:"ogr-canvas-area"},c={key:0,ref:"canvasBackground",class:"ogr-canvas-background"},u={ref:"canvas",class:"ogr-canvas"},d={key:0,ref:"postProcessCanvas",class:"ogr-post-process-canvas"},p={ref:"selectionMaskCanvas",class:"ogr-canvas-selection-mask"};var m=o(91648),h=o(19971),g=o(67340),f=o(22053),v=o(75710);const y=(0,i.aZ)({name:"AppCanvasOverlays",components:{"overlay-crop-resize":(0,i.RC)((()=>Promise.all([o.e(6617),o.e(2184)]).then(o.bind(o,92606)))),"overlay-free-transform":(0,i.RC)((()=>Promise.all([o.e(4151),o.e(2307)]).then(o.bind(o,17050)))),"overlay-selection":(0,i.RC)((()=>o.e(6240).then(o.bind(o,75913)))),"overlay-text":(0,i.RC)((()=>o.e(8416).then(o.bind(o,85804))))},props:{ignoreTransform:{type:Boolean,default:!1}},setup(e,{emit:t}){const o=["selection"];return{overlays:(0,i.Fl)((()=>{const t=[];for(const a of h.default.state.activeToolOverlays)e.ignoreTransform?o.includes(a)&&t.push(a):o.includes(a)||t.push(a);return t}))}}});var w=o(83744);const b=(0,w.Z)(y,[["render",function(e,t,o,a,n,s){return(0,i.wg)(),(0,i.iD)("div",{class:(0,r.normalizeClass)(["ogr-canvas-overlays",{"is-ignore-transform":e.ignoreTransform}])},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.overlays,(e=>((0,i.wg)(),(0,i.j4)((0,i.LL)("overlay-"+e),{key:e})))),128))],2)}]]);var T=o(85002),k=o(91457),C=o(95452),S=o(40139);const x=(0,i.aZ)({name:"AppCanvas",components:{AppCanvasOverlays:b},setup(e,{emit:t}){let a,n,r=!1;const l=(0,k.$b)("$notify"),c=(0,i.f3)("rootElement"),u=(0,i.f3)("mainElement"),d=(0,s.iH)(),p=(0,s.iH)();let y=null;const w=new Image,b=(0,s.iH)(),x=(0,s.iH)(),D=(0,s.iH)(),P=(0,s.iH)(),R=(0,s.iH)(),{viewWidth:L,viewHeight:M}=(0,s.BK)(m.Z.state),{width:A,height:Z}=(0,s.BK)(g.default.state),I=(0,s.iH)(!1);let E,G=null,z=null,O=0,B=1,H=()=>{d.value&&G&&(0,T.j)(d.value,G,{isEditorPreview:!0})};const U=(0,i.Fl)((()=>"webgl"===m.Z.state.renderer||m.Z.state.useCssViewport)),F=(0,i.Fl)((()=>f.Z.state.postProcessInterpolateImage&&!f.Z.state.useCanvasViewport&&m.Z.state.decomposedTransform.scaleX<1)),Y=(0,i.Fl)((()=>!g.default.state.background.visible||g.default.state.background.color.a<1)),W=(0,i.Fl)((()=>h.default.state.activeToolOverlays.length>0));function X(e,t){const o=m.Z.get("threejsRenderer"),a=m.Z.get("threejsCamera");o&&o.setSize(e,t,!0),a&&(a.position.z=1,a.left=0,a.right=e,a.top=0,a.bottom=t,a.updateProjectionMatrix())}async function _(e){C.Z.emit("app.canvas.calculateDndArea");const t=e&&e.margin||48;if(D.value&&u){const o=window.devicePixelRatio||1,a=(D.value.getBoundingClientRect(),u.value.getBoundingClientRect(),g.default.get("width")),n=g.default.get("height");let i=a,r=n;const s=a/n,l=a/(m.Z.get("dndAreaWidth")/o-t)/o,c=n/(m.Z.get("dndAreaHeight")/o-t)/o;l>1&&l>c?(i=a/l,r=i/s):c>1&&c>l&&(r=n/c,i=r*s);const d=m.Z.get("dndAreaLeft")+m.Z.get("dndAreaWidth")/2,p=m.Z.get("dndAreaTop")+m.Z.get("dndAreaHeight")/2,h=new DOMMatrix;if(h.translateSelf(Math.round(d-i/2),Math.round(p-r/2)),l>1||c>1){const e=l>c?1/l:1/c;h.scaleSelf(e,e)}m.Z.set("transform",h),m.Z.set("viewDirty",!0),m.Z.set("transformResetOptions",e||!0)}}function q(){try{const e=m.Z.get("viewDirty"),t=m.Z.get("playingAnimation");let o="",a=null;if(e&&(!0===U.value||W)){const e=window.devicePixelRatio,t=m.Z.get("transform");a=m.Z.get("decomposedTransform"),I.value=a.scaleX/e>=1.25;const n=t.e/a.scaleX,i=t.f/a.scaleX,r=t.rotate(-a.rotation*Math.RADIANS_TO_DEGREES).translate(-n,-i).scale(1/e,1/e).translate(n,i).rotate(a.rotation*Math.RADIANS_TO_DEGREES);o=`matrix(${r.a},${r.b},${r.c},${r.d},${r.e},${r.f})`}if(e&&(m.Z.set("viewDirty",!1),!0===U.value?(clearTimeout(E),P.value.style.transform=o,x.value&&(a.scaleX>=1?x.value.style.display="none":a.scaleX!==B&&(m.Z.get("preventPostProcess")?j():(N(),B=a.scaleX)))):(H(),x.value&&(x.value.style.display="none")),b.value&&(b.value.style.width=A.value+"px",b.value.style.height=Z.value+"px",b.value.style.transform=o,b.value.style.backgroundSize=16/a.scaleX+"px"),W&&R.value&&(R.value.$el.style.transform=o),p.value&&y&&(p.value.width=L.value,p.value.height=M.value,y.imageSmoothingEnabled=!1,y.clearRect(0,0,p.value.width,p.value.height),v.Kk.value||v.R_.value||v.K7.value))){const e=m.Z.get("transform");y.globalCompositeOperation="source-over",y.save(),y.setTransform(e.a,e.b,e.c,e.d,e.e,e.f),v.R_.value?y.drawImage(v.R_.value,v.ot.value.x,v.ot.value.y):v.Kk.value?y.drawImage(v.Kk.value,v.pt.value.x,v.pt.value.y):v.K7.value&&y.drawImage(v.K7.value,v._G.value.x,v._G.value.y),y.restore(),y.globalCompositeOperation="source-out";const t=y.createPattern(w,"repeat")||"#00000044";y.fillStyle=t,y.fillRect(0,0,p.value.width,p.value.height)}if(m.Z.get("dirty")||t){if(m.Z.set("dirty",!1),t){const e=performance.now(),{timelinePlayStartTime:t,timelineStart:o,timelineEnd:a}=h.default.state,n=(e-t)%(a-o)+o;h.default.dispatch("setTimelineCursor",n)}H(),x.value&&(x.value.style.display="none",m.Z.get("preventPostProcess")?j():N())}}catch(e){!1===f.Z.get("useCanvasViewport")&&(e||"").toString().includes("NS_ERROR_FAILURE")?(clearTimeout(E),f.Z.set("useCanvasViewport",!0),m.Z.set("useCssViewport",!1),m.Z.set("viewDirty",!1),m.Z.set("dirty",!1),l({type:"info",message:"Switching viewport to optimize for large images. Some features such as high quality scaling are disabled."})):(m.Z.set("viewDirty",!1),m.Z.set("dirty",!1),l({type:"error",title:"Can't Draw Image",message:"The image could be too large or some other error could have occurred."}))}requestAnimationFrame(q)}function N(){if(m.Z.get("playingAnimation")||Y)return;const e=d.value,t=x.value;n&&e&&t&&(t.style.display="none",clearTimeout(E),z&&(z(),z=null),E=window.setTimeout((()=>{const o=m.Z.get("decomposedTransform");t.width=Math.floor(e.width*o.scaleX),t.height=Math.floor(e.height*o.scaleX);let a=new Promise(((e,t)=>{z=t}));n.resize(e,t,{cancelToken:a}).then((()=>{t.style.display="block",t.style.transform=`scale(${1/o.scaleX})`,V()})).catch((()=>{t.style.display="none",V()}))}),100))}function j(){B=-1,x.value&&(x.value.style.display="none",x.value.width=1,x.value.height=1),clearTimeout(E),z&&(z(),z=null)}function V(){O>5&&(r?(f.Z.set("postProcessInterpolateImage",!1),l({type:"info",message:"High quality scaling is slowing down the viewport. It was automatically disabled."})):(console.warn("[WARNING] Pica main thread process took too long, defaulting to single thread."),O=0,r=!0,n=new a({concurrency:1})))}return m.Z.set("workingImageBorderColor",getComputedStyle(document.documentElement).getPropertyValue("--ogr-working-image-border-color")),(0,i.m0)((async()=>{if("webgl"===m.Z.state.renderer){const e=m.Z.get("threejsRenderer"),t=m.Z.get("threejsScene");if(t&&e){const{r:a,g:n,b:i,a:r}=(0,S.cp)(g.default.state.background.color,(0,S.VT)(g.default.state.background.color));e.setClearColor((new((await Promise.resolve().then(o.bind(o,17282))).Color)).setRGB(a,n,i),r),t.background=null}m.Z.set("dirty",!0)}})),(0,i.YP)([U],(([e])=>{const t=m.Z.get("viewCanvas"),o=m.Z.get("bufferCanvas");e?(t.width=g.default.get("width"),t.height=g.default.get("height"),x.value&&(x.value.style.display="block",x.value.width=t.width,x.value.height=t.height),o.width=1,o.height=1):(P.value.style.transform="",t.width=L.value,t.height=M.value,x.value&&(x.value.style.display="none"),o.width=g.default.get("width"),o.height=g.default.get("height")),m.Z.set("dirty",!0)})),(0,i.YP)([L,M],(([e,t])=>{const o=d.value;o&&(!1===U.value&&(o.width=e,o.height=t),H()),m.Z.set("viewDirty",!0)})),(0,i.YP)([A,Z],(([e,t])=>{const o=m.Z.get("viewCanvas"),a=m.Z.get("bufferCanvas"),n=m.Z.get("renderer");!0===U.value?(o.width=e,o.height=t,x.value&&(x.value.width=o.width,x.value.height=o.height),a.width=10,a.height=10):(a.width=e,a.height=t),"webgl"===n&&X(e,t),m.Z.set("dirty",!0)})),(0,i.bv)((async()=>{if(C.Z.on("app.canvas.resetTransform",_),d.value){const e=g.default.get("width"),t=g.default.get("height");c?.value&&(m.Z.set("viewWidth",c.value.clientWidth*(window.devicePixelRatio||1)),m.Z.set("viewHeight",c.value.clientHeight*(window.devicePixelRatio||1))),!1===U.value?(d.value.width=L.value,d.value.height=M.value,x.value&&(x.value.style.display="none")):(d.value.width=e,d.value.height=t,x.value&&(x.value.style.display="block",x.value.width=e,x.value.height=t));let i="2d";if("webgl"===f.Z.get("renderer")&&function(){try{const e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}()&&(i="webgl"),"webgl"===i){const{WebGLRenderer:a}=await Promise.all([o.e(4152),o.e(5268)]).then(o.bind(o,5268)),{Scene:n}=await o.e(4963).then(o.bind(o,94963)),{OrthographicCamera:i}=await o.e(4152).then(o.bind(o,44152));try{const o=new a({alpha:!0,canvas:d.value});o.setSize(1,1),m.Z.set("threejsRenderer",o);const r=new n;m.Z.set("threejsScene",r);const s=new i(-1,1,1,-1,1,1e4);m.Z.set("threejsCamera",s),m.Z.set("renderer","webgl"),X(e,t),H=()=>{(0,T.d)(o,r,s,{isEditorPreview:!0})},H(),G=o.context,m.Z.set("useCssViewport",!0)}catch(e){console.error(e)}}if("2d"===i){const o=d.value.getContext("2d"),a=document.createElement("canvas");a.width=!0===U.value?10:e,a.height=!0===U.value?10:t;let n=a.getContext("2d");o&&n&&(G=o,m.Z.set("bufferCanvas",a),m.Z.set("bufferCtx",n))}G&&m.Z.set("viewCtx",G),m.Z.set("viewCanvas",d.value),q(),a=(await o.e(802).then(o.t.bind(o,40802,23))).default;const r=a.prototype.__extractTileData;a.prototype.__extractTileData=function(){const e=window.performance.now(),t=r.apply(this,arguments);return O=.75*O+.25*(window.performance.now()-e),t},n=new a({idle:2e4})}p.value&&(m.Z.set("selectionMaskCanvas",p.value),y=p.value.getContext("2d"),w.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAABg2lDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV/TiiIVh3YQcchQnVoQFXHUKhShQqgVWnUwufQLmjQkKS6OgmvBwY/FqoOLs64OroIg+AHi6OSk6CIl/i8ptIjx4Lgf7+497t4BQrPKNCs0Dmi6bWZSSTGXXxV7XyEgghDiCMjMMuYkKQ3f8XWPAF/vEjzL/9yfY0AtWAwIiMSzzDBt4g3i6U3b4LxPHGVlWSU+J46bdEHiR64rHr9xLrks8Myomc3ME0eJxVIXK13MyqZGPEUcUzWd8oWcxyrnLc5atc7a9+QvDBf0lWWu0xxBCotYggQRCuqooAobCVp1UixkaD/p4x92/RK5FHJVwMixgBo0yK4f/A9+d2sVJye8pHAS6HlxnI9RoHcXaDUc5/vYcVonQPAZuNI7/loTmPkkvdHRYkfA4DZwcd3RlD3gcgcYejJkU3alIE2hWATez+ib8kDkFuhf83pr7+P0AchSV+kb4OAQGCtR9rrPu/u6e/v3TLu/Hx5FcoXj45C+AAAABmJLR0QATgBOAE714JEKAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH5gITBDkEOkUYUQAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAtSURBVAjXY/z//383AxT4+/szMCFzNm7cCBGAcRgYGBiYz58/7wbjMDAwMAAAGKUPRK2REh8AAAAASUVORK5CYII=")})),(0,i.Ah)((()=>{C.Z.off("app.canvas.resetTransform",_)})),{canvas:d,canvasArea:D,canvasBackground:b,canvasContainer:P,canvasOverlays:R,selectionMaskCanvas:p,postProcessCanvas:x,isPixelatedZoomLevel:I,useCanvasBackground:Y,usePostProcess:F,useCssViewport:U}}}),D=(0,w.Z)(x,[["render",function(e,t,o,a,n,s){const m=(0,i.up)("app-canvas-overlays");return(0,i.wg)(),(0,i.iD)("div",l,[e.useCanvasBackground?((0,i.wg)(),(0,i.iD)("div",c,null,512)):(0,i.kq)("v-if",!0),(0,i._)("div",{ref:"canvasContainer",class:(0,r.normalizeClass)(["ogr-canvas-container",{"ogr-canvas-viewport-css":e.useCssViewport,"ogr-canvas-viewport-css--pixelated":e.isPixelatedZoomLevel}])},[(0,i._)("canvas",u,null,512),e.usePostProcess?((0,i.wg)(),(0,i.iD)("canvas",d,null,512)):(0,i.kq)("v-if",!0)],2),(0,i._)("canvas",p,null,512),(0,i.Wm)(m,{ref:"canvasOverlays"},null,512),(0,i.Wm)(m,{"ignore-transform":!0})],512)}]]),P={class:"ogr-dialogs"},R={class:"is-position-absolute-full"},L={class:"ogr-dock"},M={style:{width:"5rem",height:"5rem",margin:"auto"},"element-loading-background":"transparent"};var A=o(43019);const Z=(0,i.aZ)({name:"Dock",directives:{loading:A.ZP.directive},components:{"color-picker":(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(3919),o.e(8877),o.e(1522),o.e(5011),o.e(3631),o.e(4026),o.e(8444),o.e(7121)]).then(o.bind(o,55127)))),layers:(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(8107),o.e(8877),o.e(6201),o.e(8154),o.e(8041),o.e(4586),o.e(9116),o.e(8444),o.e(7804)]).then(o.bind(o,98898)))),settings:(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(3919),o.e(8877),o.e(6276),o.e(5407),o.e(9414),o.e(9080),o.e(8223),o.e(6201),o.e(8959),o.e(8041),o.e(4468),o.e(5011),o.e(0),o.e(3198),o.e(4937),o.e(3359),o.e(9116),o.e(1766)]).then(o.bind(o,16680))))},emits:["close","update:title"],props:{isDialog:{type:Boolean,default:!1},name:{type:String,required:!0},props:{type:Object}},setup:(e,{emit:t})=>({onCloseDock:function(){t("close",...arguments)},onUpdateTitle:function(){t("update:title",...arguments)}})}),I=(0,w.Z)(Z,[["render",function(e,t,o,a,n,r){const s=(0,i.Q2)("loading");return(0,i.wg)(),(0,i.iD)("div",L,[((0,i.wg)(),(0,i.j4)(i.n4,null,{default:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)((0,i.LL)(e.name),(0,i.dG)({"is-dialog":e.isDialog},e.props,{onClose:e.onCloseDock,"onUpdate:title":e.onUpdateTitle}),null,16,["is-dialog","onClose","onUpdate:title"]))])),fallback:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",M,null,512),[[s,!0]])])),_:1}))])}]]),E={class:"ogr-module"},G={style:{width:"100%",height:"5rem"},"element-loading-background":"transparent"},z=(0,i.aZ)({name:"Module",directives:{loading:A.ZP.directive},components:{"file-export":(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(3919),o.e(8877),o.e(6276),o.e(5407),o.e(9414),o.e(9080),o.e(8223),o.e(6201),o.e(8959),o.e(7588),o.e(1522),o.e(6702),o.e(8341),o.e(2912),o.e(5136)]).then(o.bind(o,21806)))),"file-new":(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(8107),o.e(3919),o.e(8877),o.e(6276),o.e(5407),o.e(9414),o.e(9080),o.e(8223),o.e(7588),o.e(7063),o.e(7475)]).then(o.bind(o,57716)))),"file-save-as":(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(3919),o.e(6276),o.e(5407),o.e(6201),o.e(8959),o.e(7588),o.e(8341),o.e(9592),o.e(7808)]).then(o.bind(o,45236)))),"file-take-photo":(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(8107),o.e(3919),o.e(8877),o.e(8223),o.e(6201),o.e(1142)]).then(o.bind(o,42882)))),"image-convert-layers-to-image-sequence":(0,i.RC)((()=>Promise.all([o.e(376),o.e(8107),o.e(3919),o.e(6276),o.e(5407),o.e(9414),o.e(9080),o.e(7588),o.e(1286),o.e(8190)]).then(o.bind(o,61090)))),"tutorial-welcome":(0,i.RC)((()=>Promise.all([o.e(4586),o.e(2435),o.e(9457)]).then(o.bind(o,39091))))},props:{isDialog:{type:Boolean,default:!1},name:{type:String,required:!0},props:{type:Object}},emits:["update:title","close"],setup:(e,{emit:t})=>({onCloseModule:function(){t("close",...arguments)},onSetTitle:function(e){t("update:title",e)}})}),O=(0,w.Z)(z,[["render",function(e,t,o,a,n,r){const s=(0,i.Q2)("loading");return(0,i.wg)(),(0,i.iD)("div",E,[((0,i.wg)(),(0,i.j4)(i.n4,null,{default:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)((0,i.LL)(e.name),(0,i.dG)({"is-dialog":e.isDialog},e.props,{"onUpdate:title":t[0]||(t[0]=t=>e.onSetTitle(t)),onClose:t[1]||(t[1]=t=>e.onCloseModule(t))}),null,16,["is-dialog"]))])),fallback:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",G,null,512),[[s,!0]])])),_:1}))])}]]),B=(0,i.aZ)({name:"AppDialogs",directives:{loading:A.ZP.directive},components:{Dock:I,ElDialog:(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(7982),o.e(8034)]).then(o.bind(o,75971)))),Module:O},setup(){let e=0;const t=(0,s.iH)([]);function o(o){o&&t.value.push({type:"dock",id:e++,title:"",visible:!0,dock:o,size:"medium",props:o.props,onClose:o.onClose})}function a(o){o&&t.value.push({type:"module",id:e++,title:"",visible:!0,module:o,size:"medium",props:o.props,onClose:o.onClose})}return(0,i.bv)((()=>{C.Z.on("app.dialogs.openFromDock",o),C.Z.on("app.dialogs.openFromModule",a)})),(0,i.Ah)((()=>{C.Z.off("app.dialogs.openFromDock",o),C.Z.off("app.dialogs.openFromModule",a)})),{dialogs:t,onCloseDialog:function(e,t){e.visible=!1,e.closeEventData=t,e.closeEventData&&e.onClose&&e.onClose(e.closeEventData)},onDialogClosed:function(e){!e.closeEventData&&e.onClose&&e.onClose(e.closeEventData),t.value.splice(t.value.indexOf(e),1)}}}}),H=(0,w.Z)(B,[["render",function(e,t,o,a,n,r){const s=(0,i.up)("dock"),l=(0,i.up)("module"),c=(0,i.up)("el-dialog"),u=(0,i.Q2)("loading");return(0,i.wg)(),(0,i.iD)("div",P,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.dialogs,(t=>((0,i.wg)(),(0,i.j4)(i.n4,{key:t.id},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{title:e.$t(t.title||"empty"),"custom-class":"el-dialog--"+t.size+" el-dialog--ogr-"+t.type,modelValue:t.visible,"onUpdate:modelValue":e=>t.visible=e,"destroy-on-close":"",onClosed:o=>e.onDialogClosed(t)},{default:(0,i.w5)((()=>["dock"===t.type?((0,i.wg)(),(0,i.j4)(s,{key:0,name:t.dock.name,"is-dialog":!0,props:t.props,"onUpdate:title":e=>t.title=e,onClose:o=>e.onCloseDialog(t,o)},null,8,["name","props","onUpdate:title","onClose"])):"module"===t.type?((0,i.wg)(),(0,i.j4)(l,{key:1,name:t.module.name,"is-dialog":!0,props:t.props,"onUpdate:title":e=>t.title=e,onClose:o=>e.onCloseDialog(t,o)},null,8,["name","props","onUpdate:title","onClose"])):(0,i.kq)("v-if",!0)])),_:2},1032,["title","custom-class","modelValue","onUpdate:modelValue","onClosed"])])),fallback:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",R,null,512),[[u,!0]])])),_:2},1024)))),128))])}]]),U={class:"ogr-dnd-drop-overlay"},F={class:"ogr-dnd-drop-overlay__center"},Y=(0,i.uE)('<div class="ogr-dnd-drop-corner-top-left"><svg viewBox="0 0 100 100"><path d="M1.5 1.5 L98.5 1.5 L98.5 25 L25 25 L25 98.5 L1.5 98.5 Z" fill="white" stroke="#ccc" stroke-width="3"></path></svg></div><div class="ogr-dnd-drop-corner-top-right"><svg viewBox="0 0 100 100"><path d="M1.5 1.5 L98.5 1.5 L98.5 25 L25 25 L25 98.5 L1.5 98.5 Z" fill="white" stroke="#ccc" stroke-width="3"></path></svg></div><div class="ogr-dnd-drop-corner-bottom-left"><svg viewBox="0 0 100 100"><path d="M1.5 1.5 L98.5 1.5 L98.5 25 L25 25 L25 98.5 L1.5 98.5 Z" fill="white" stroke="#ccc" stroke-width="3"></path></svg></div><div class="ogr-dnd-drop-corner-bottom-right"><svg viewBox="0 0 100 100"><path d="M1.5 1.5 L98.5 1.5 L98.5 25 L25 25 L25 98.5 L1.5 98.5 Z" fill="white" stroke="#ccc" stroke-width="3"></path></svg></div>',4),W=(0,i.aZ)({name:"AppDndDropOverlay",setup(e,t){}}),X=(0,w.Z)(W,[["render",function(e,t,o,a,n,r){const s=(0,i.Q2)("t");return(0,i.wg)(),(0,i.iD)("div",U,[(0,i.wy)((0,i._)("div",F,null,512),[[s,"app.dndDropOverlay.addImage"]]),Y])}]]),_={ref:"header"},q=(0,i._)("h1",{class:"is-sr-only"},"OpenGraphica",-1),N={class:"ogr-layout-dnd-center"},j={"aria-label":"Left Sidebar",class:"sidebar-left",ref:"sidebarLeft"},V={"aria-label":"Right Sidebar",class:"sidebar-right",ref:"sidebarRight"},K={ref:"footer"},$={ref:"dockLayout",class:"ogr-layout-dock",style:{width:"320px"}},Q={key:0,class:"ogr-dock-title"},J=(0,i.aZ)({name:"AppLayoutDock",components:{Dock:I},props:{config:{type:Object,required:!0},layoutPlacement:{type:String,default:"right"}},emit:["resize"],setup(e,{emit:t}){const o=(0,s.iH)();return(0,i.bv)((()=>{t("resize")})),{dockLayout:o}}}),ee=(0,w.Z)(J,[["render",function(e,t,o,a,n,s){const l=(0,i.up)("dock"),c=(0,i.Q2)("t");return(0,i.wg)(),(0,i.iD)("div",$,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.config.layout,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e.name,class:"ogr-layout-dock__container",style:(0,r.normalizeStyle)({height:100*e.ratio+"%"})},[e.title?(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",Q,null,512)),[[c,e.title]]):(0,i.kq)("v-if",!0),(0,i.Wm)(l,{name:e.name,"onUpdate:title":t=>e.title=t},null,8,["name","onUpdate:title"])],4)))),128))],512)}]]),te={ref:"flexContainer",class:"is-flex container mx-auto"},oe={key:0,class:"ogr-menu-section__title"},ae={key:0,class:"ml-2"},ne=(0,i.Uk)("Ctrl + K"),ie={key:0,class:"ogr-dock-title"},re={key:1,class:"px-3 py-2"},se={class:"ogr-menu-end px-3",style:{height:"0px",overflow:"hidden",visibility:"hidden"}},le=(0,i._)("span",{class:"el-icon","aria-hidden":"true"},null,-1);var ce=o(64670),ue=o(20608),de=o(20345);const pe=JSON.parse('{"color":{"name":"layoutShortcutGroup.color.name","controls":[{"type":"button","icon":"bi bi-eyedropper","label":"layoutShortcutGroup.color.controls.default.label","action":{"type":"runModule","target":"tmp/notYetImplemented"}}],"draggable":true},"deform":{"name":"layoutShortcutGroup.deform.name","controls":[{"type":"button","icon":"bi bi-droplet","label":"layoutShortcutGroup.deform.controls.default.label","action":{"type":"runModule","target":"tmp/notYetImplemented"}}],"draggable":true},"draw":{"name":"layoutShortcutGroup.draw.name","controls":[{"type":"button","icon":"bi bi-brush","label":"layoutShortcutGroup.draw.controls.default.label","action":{"type":"runModule","target":"tmp/notYetImplemented"}}],"draggable":true},"effects":{"name":"layoutShortcutGroup.effects.name","controls":[{"type":"button","icon":"bi bi-stars","label":"layoutShortcutGroup.effects.controls.default.label","action":{"type":"runModule","target":"tmp/notYetImplemented"}}],"draggable":true},"erase":{"name":"layoutShortcutGroup.erase.name","controls":[{"type":"button","icon":"bi bi-eraser","label":"layoutShortcutGroup.erase.controls.default.label","action":{"type":"runModule","target":"tmp/notYetImplemented"}}],"draggable":true},"history":{"name":"layoutShortcutGroup.history.name","controls":[{"type":"button","icon":"bi bi-arrow-counterclockwise","label":"layoutShortcutGroup.history.controls.undo.label","action":{"type":"runModule","target":"tmp/notYetImplemented"}},{"type":"button","icon":"bi bi-arrow-clockwise","label":"layoutShortcutGroup.history.controls.redo.label","action":{"type":"runModule","target":"tmp/notYetImplemented"}}],"draggable":true},"layers":{"name":"layoutShortcutGroup.layers.name","controls":[{"type":"button","icon":"bi bi-layers","label":"layoutShortcutGroup.layers.controls.default.label","action":{"type":"dock","target":"layers"}}],"draggable":true},"search":{"name":"layoutShortcutGroup.search.name","controls":[{"type":"button","icon":"bi bi-search","label":"layoutShortcutGroup.search.controls.default.label","action":{"type":"runModule","target":"tmp/notYetImplemented"}}],"draggable":true},"selection":{"name":"layoutShortcutGroup.selection.name","controls":[{"type":"button","icon":"bi bi-bounding-box","label":"layoutShortcutGroup.selection.controls.default.label","action":{"type":"toolGroup","target":"selection"}}],"draggable":true},"settings":{"name":"layoutShortcutGroup.settings.name","controls":[{"type":"button","icon":"bi bi-gear","label":"layoutShortcutGroup.settings.controls.default.label","action":{"type":"dock","target":"settings"}}],"draggable":true},"text":{"name":"layoutShortcutGroup.text.name","controls":[{"type":"button","icon":"bi bi-type","label":"layoutShortcutGroup.text.controls.default.label","action":{"type":"toolGroup","target":"text"}}],"draggable":true},"transform":{"name":"layoutShortcutGroup.transform.name","controls":[{"type":"button","icon":"bi bi-cursor","label":"layoutShortcutGroup.transform.controls.default.label","action":{"type":"toolGroup","target":"transform"}}],"draggable":true},"view":{"name":"layoutShortcutGroup.view.name","controls":[{"type":"button","icon":"bi bi-zoom-in","label":"layoutShortcutGroup.view.controls.default.label","action":{"type":"toolGroup","target":"view"}}],"draggable":true}}'),me=(0,i.aZ)({name:"VFragment",inheritAttrs:!1}),he=(0,w.Z)(me,[["render",function(e,t,o,a,n,r){return(0,i.WI)(e.$slots,"default")}]]);var ge=o(9723);const fe=(0,i.aZ)({name:"AppLayoutMenuBar",directives:{loading:A.ZP.directive},components:{DynamicallyLoadedDock:I,ElButton:ce.ZP,ElButtonGroup:ce.MO,ElDrawer:(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(7982),o.e(8034)]).then(o.bind(o,25174)))),ElMenu:(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(8041),o.e(9116)]).then(o.bind(o,37447)))),ElMenuItem:(0,i.RC)((async()=>(await Promise.all([o.e(4736),o.e(376),o.e(8041),o.e(9116)]).then(o.bind(o,37447))).ElMenuItem)),ElPopover:ue.Z,ElScrollbar:(0,i.RC)((()=>o.e(8877).then(o.bind(o,17765)))),ElTag:de.default,VFragment:he},props:{config:{type:Object,required:!0},layoutPlacement:{type:String,default:"top"}},emit:["resize"],setup(e,{emit:t}){let o,a,n,r,l=null,c=null,u=(0,s.iH)(),d=(0,s.iH)("all"),p=(0,s.iH)("horizontal"),g=(0,s.iH)(!1),v=(0,s.iH)(!1),y=(0,s.iH)("top"),w=null,b=!1;const{viewWidth:T,viewHeight:k}=(0,s.BK)(m.Z.state),{activeToolGroup:S,activeTool:x}=(0,s.BK)(h.default.state),D=(0,s.iH)(function(t){l=null,c=null,t=t||d.value;let o={};const a=["docks","tools"];for(let t of a)if(e.config.layout[t]){const a=[];for(let o of e.config.layout[t]||[]){const e={id:o,...pe[o]};if(e.controls)for(let t of e.controls)t.displayTitle="",t.popoverVisible=!1,t.showDock=!1;a.push(e)}o[t]=a}return o}()),P=(0,i.Fl)((()=>h.default.state.activeMenuDrawerComponentName));function R(e){E(e)}function L(e){G(e)}function M(e){E(e)}function A(e){G(e)}function Z(e,t){e.preventDefault(),e.target&&l&&(e.target,l.popoverVisible=!1),w=e.target,a=e.touches?e.touches[0].identifier:0,n=e.button||0,b=t.showDock||!1,clearTimeout(r),r=window.setTimeout((()=>{w=null,n=-1,a=-1}),f.Z.get("pointerPressHoldTimeout"))}function I(e,t){clearTimeout(r);let o=a;if(e.touches)for(let t=0;t<e.touches.length;t++)if(e.touches[t].identifier===a){a=-1;break}const i=e.button||0;w===e.target&&n===i&&a===o&&(z("popover",i,t),w=null,n=-1,a=-1,e.target.closest("button").focus())}function E(e){if(e.target&&l){const t=e.target;t.closest&&t.closest(".el-popover")||(l.popoverVisible=!1)}}function G(e){clearTimeout(r);let t=a;if(e.touches)for(let t=0;t<e.touches.length;t++)if(e.touches[t].identifier===a){a=-1;break}const o=e.button||0;n===o&&a===t&&(w=null,n=-1,a=-1)}async function z(e,t,o){if(l)c=arguments;else if(o.action)if("toolGroup"===o.action.type)0===t&&S.value!==o.action.target&&(h.default.dispatch("setActiveTool",{group:o.action.target}),"modal"===e&&(g.value=!1));else if("dock"===o.action.type)"popover"===e?b?o.popoverVisible=!1:window.innerWidth<550?(o.popoverVisible=!1,C.Z.emit("app.menuDrawer.openFromDock",{name:o.action.target,placement:y.value})):(l=o,o.showDock=!0,o.popoverVisible=!0,C.Z.emit("app.menuDrawer.closeAll")):"modal"===e&&(C.Z.emit("app.dialogs.openFromDock",{name:o.action.target}),g.value=!1);else if("runModule"===o.action.type){const e=o.action.target.split("/");await(0,ge.Mz)(e[0],e[1])}}return(0,i.YP)([T],(()=>{window.clearTimeout(o),o=window.setTimeout((async()=>{d.value=T.value/(window.devicePixelRatio||1)>f.Z.state.dockHideBreakpoint?"tools":"all"}),400)})),(0,i.YP)([d],(()=>{g.value=!1})),(0,i.YP)((()=>e.layoutPlacement),(e=>{p.value=["left","right"].includes(e)?"vertical":"horizontal",y.value={bottom:"top",top:"bottom",left:"right",right:"left"}[e]}),{immediate:!0}),(0,i.bv)((()=>{window.addEventListener("mousedown",M),window.addEventListener("mouseup",A),window.addEventListener("touchstart",R),window.addEventListener("touchend",L),d.value=T.value/(window.devicePixelRatio||1)>f.Z.state.dockHideBreakpoint?"tools":"all",t("resize")})),(0,i.Ah)((()=>{window.removeEventListener("mousedown",M),window.removeEventListener("mouseup",A),window.removeEventListener("touchstart",R),window.removeEventListener("touchend",L)})),{activeMenuDrawerComponentName:P,showMoreActionsMenu:g,showMoreActionsTooltip:v,popoverPlacement:y,displayMode:d,direction:p,flexContainer:u,actionGroups:D,activeToolGroup:S,activeTool:x,onAfterLeavePopover:function(e){e===l&&(l=null,e.showDock=!1,c&&(z.apply(window,c),c=null))},onKeyDownControlButton:function(e,t){"Enter"===e.key&&z("popover",0,t)},onTouchStartControlButton:function(e,t){Z(e,t)},onTouchEndControlButton:function(e,t){I(e,t)},onTouchMoveMenuBar:function(e){if(w)for(let t=0;t<e.touches.length;t++)if(e.touches[t].identifier===a){w!==e.touches[t].target&&clearTimeout(r);break}},onMouseDownControlButton:function(e,t){Z(e,t)},onMouseUpControlButton:function(e,t){I(e,t)},onMouseEnterControlButton:function(e,t){t.showDock||t.expanded||(t.popoverVisible=!0)},onMouseLeaveControlButton:function(e,t){t.showDock||t.expanded||(t.popoverVisible=!1),clearTimeout(r)},onPressControlButton:z}}}),ve=(0,w.Z)(fe,[["render",function(e,t,o,a,n,s){const l=(0,i.up)("el-tag"),c=(0,i.up)("el-button"),u=(0,i.up)("dynamically-loaded-dock"),d=(0,i.up)("el-popover");return(0,i.wg)(),(0,i.iD)("div",{class:(0,r.normalizeClass)(["ogr-layout-menu-bar theme-dark",["is-positioned-"+e.layoutPlacement,{"is-vertical":"vertical"===e.direction,"is-menu-drawer-open":null!=e.activeMenuDrawerComponentName}]]),onTouchmove:t[0]||(t[0]=t=>e.onTouchMoveMenuBar(t))},[(0,i._)("div",te,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.actionGroups,((t,o)=>((0,i.wg)(),(0,i.iD)("div",{key:o,class:(0,r.normalizeClass)(["ogr-menu-section my-2",["ogr-menu-"+o,{"px-3":"tools"!==o}]])},["tools"===o?((0,i.wg)(),(0,i.iD)("span",oe,(0,r.toDisplayString)(e.$t("menuBar.toolsHeading")),1)):(0,i.kq)("v-if",!0),"all"===e.displayMode||"tools"===o?((0,i.wg)(),(0,i.j4)((0,i.LL)("tools"===o?"el-scrollbar":"v-fragment"),{key:1},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t,(t=>((0,i.wg)(),(0,i.j4)((0,i.LL)(1===t.controls.length?"div":"el-button-group"),{key:t.id,class:(0,r.normalizeClass)({"ogr-single-button-group":1===t.controls.length})},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.controls,(t=>((0,i.wg)(),(0,i.j4)(d,{key:t.label,visible:t.popoverVisible,"onUpdate:visible":e=>t.popoverVisible=e,trigger:"manual",effect:"light",placement:e.popoverPlacement,"popper-class":"ogr-dock-popover","show-after":0,"hide-after":0,transition:t.showDock?"el-fade-in-linear":"none","popper-options":{boundariesElement:"body"},"append-to":".opengraphica",onAfterLeave:o=>e.onAfterLeavePopover(t)},{reference:(0,i.w5)((()=>[(0,i.Wm)(c,{"aria-label":e.$t(t.label),type:[e.activeToolGroup,e.activeMenuDrawerComponentName].includes(t.action&&t.action.target)?"primary":void 0,plain:![e.activeToolGroup,e.activeMenuDrawerComponentName].includes(t.action&&t.action.target),circle:!t.expanded,round:t.expanded,class:(0,r.normalizeClass)({"el-button--expanded-group":t.expanded,"el-button--expanded-popover":t.showDock}),onTouchstart:o=>e.onTouchStartControlButton(o,t),onTouchend:o=>e.onTouchEndControlButton(o,t),onMousedown:o=>e.onMouseDownControlButton(o,t),onMouseup:o=>e.onMouseUpControlButton(o,t),onMouseenter:o=>e.onMouseEnterControlButton(o,t),onMouseleave:o=>e.onMouseLeaveControlButton(o,t),onKeydown:o=>e.onKeyDownControlButton(o,t)},{default:(0,i.w5)((()=>[(0,i._)("span",{class:(0,r.normalizeClass)(["el-icon",t.icon]),"aria-hidden":"true"},null,2),t.expanded?((0,i.wg)(),(0,i.iD)("span",ae,(0,r.toDisplayString)(e.$t(t.label)),1)):(0,i.kq)("v-if",!0),t.expanded?((0,i.wg)(),(0,i.j4)(l,{key:1,type:"info",class:"ml-2 el-tag--mini"},{default:(0,i.w5)((()=>[ne])),_:1})):(0,i.kq)("v-if",!0)])),_:2},1032,["aria-label","type","plain","circle","round","class","onTouchstart","onTouchend","onMousedown","onMouseup","onMouseenter","onMouseleave","onKeydown"])])),default:(0,i.w5)((()=>[t.showDock?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[t.displayTitle?((0,i.wg)(),(0,i.iD)("div",ie,(0,r.toDisplayString)(t.displayTitle),1)):(0,i.kq)("v-if",!0),((0,i.wg)(),(0,i.j4)(u,{name:t.action.target,key:"dock-"+t.action.target,"onUpdate:title":e=>t.displayTitle=e,onClose:e=>t.popoverVisible=!1},null,8,["name","onUpdate:title","onClose"]))],64)):((0,i.wg)(),(0,i.iD)("div",re,(0,r.toDisplayString)(e.$t(t.label)),1))])),_:2},1032,["visible","onUpdate:visible","placement","transition","onAfterLeave"])))),128))])),_:2},1032,["class"])))),128))])),_:2},1024)):(0,i.kq)("v-if",!0)],2)))),128)),(0,i._)("div",se,[(0,i.Wm)(c,{"aria-hidden":"true",circle:"",round:""},{default:(0,i.w5)((()=>[le])),_:1})])],512)],34)}]]),ye=(0,i._)("div",null,null,-1),we=(0,i.aZ)({name:"Toolbar",directives:{loading:A.ZP.directive},components:{"toolbar-crop-resize":(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(8107),o.e(3919),o.e(8877),o.e(6276),o.e(5407),o.e(9414),o.e(9080),o.e(8223),o.e(8959),o.e(8154),o.e(4468),o.e(4586),o.e(6617),o.e(6417)]).then(o.bind(o,54140)))),"toolbar-selection":(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(3919),o.e(8877),o.e(6276),o.e(5407),o.e(9414),o.e(9080),o.e(8223),o.e(6201),o.e(4468),o.e(2615),o.e(7320)]).then(o.bind(o,93467)))),"toolbar-free-transform":(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(8107),o.e(3919),o.e(8877),o.e(6276),o.e(5407),o.e(9414),o.e(9080),o.e(8223),o.e(6201),o.e(8959),o.e(4586),o.e(2615),o.e(4151),o.e(1745)]).then(o.bind(o,60463)))),"toolbar-text":(0,i.RC)((()=>Promise.all([o.e(4736),o.e(376),o.e(3919),o.e(8877),o.e(6276),o.e(5407),o.e(9414),o.e(9080),o.e(8223),o.e(2615),o.e(4653)]).then(o.bind(o,2863)))),"toolbar-zoom":(0,i.RC)((()=>Promise.all([o.e(376),o.e(3919),o.e(8877),o.e(6276),o.e(5407),o.e(9414),o.e(9080),o.e(2615),o.e(1388)]).then(o.bind(o,16793))))},emits:[],props:{name:{type:String,required:!0}},setup(e,{emit:t}){const o=(0,s.iH)(""),a=(0,s.iH)("");return(0,i.YP)([(0,s.Vh)(e,"name")],(async()=>{o.value="out"})),(0,i.bv)((()=>{a.value=e.name})),{currentName:a,animationSwap:o,onLoadToolbarResolve:function(){o.value="in"},onToolbarAnimationEnd:function(){"out"===o.value?a.value=e.name:"in"===o.value&&(o.value="")},onCloseToolbar:function(){h.default.dispatch("setActiveTool",{group:h.default.get("activeToolGroupPrevious")||"",tool:h.default.get("activeToolPrevious")||""})}}}}),be=(0,w.Z)(we,[["render",function(e,t,o,a,n,s){return(0,i.wg)(),(0,i.iD)("div",{class:(0,r.normalizeClass)(["ogr-toolbar",{"is-swap-in":"in"===e.animationSwap,"is-swap-out":"out"===e.animationSwap}]),onAnimationend:t[0]||(t[0]=(...t)=>e.onToolbarAnimationEnd&&e.onToolbarAnimationEnd(...t))},[((0,i.wg)(),(0,i.j4)(i.n4,{onResolve:e.onLoadToolbarResolve},{default:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)((0,i.LL)("toolbar-"+e.currentName),{onClose:e.onCloseToolbar},null,8,["onClose"]))])),fallback:(0,i.w5)((()=>[ye])),_:1},8,["onResolve"]))],34)}]]),Te=JSON.parse('{"L":{"menuBar":{"layout":{"docks":["settings","layers"],"tools":["view","transform","selection"]}},"dock":{"layout":[{"name":"settings","ratio":0.4},{"name":"layers","ratio":0.6}]}}}');var ke=o(84710);const Ce=(0,i.aZ)({name:"AppLayoutDndContainer",components:{AppLayoutDock:ee,AppLayoutMenuBar:ve,Toolbar:be},emits:["dnd-ready","resize"],setup(e,{emit:t}){const o=(0,s.iH)(),a=(0,s.iH)(),n=(0,s.iH)(),r=(0,s.iH)(),l=(0,s.iH)(),c=(0,s.iH)(Te.L),u=(0,s.iH)(!1),d=(document.body,(0,s.iH)(0)),p=(0,s.iH)(0),g=(0,s.iH)(!0),{viewWidth:v,viewHeight:y}=(0,s.BK)(m.Z.state),w=(0,i.Fl)((()=>h.default.state.activeToolbar)),b=(0,i.Fl)((()=>h.default.state.activeToolbarPosition)),T=(0,i.Fl)((()=>f.Z.state.dockPosition)),k=(0,i.Fl)((()=>h.default.state.isActiveToolbarExclusive)),S=(0,i.Fl)((()=>0===h.default.state.activePopoverIds.length)),x=(0,i.Fl)((()=>f.Z.state.menuBarPosition));let D;function P(){if(o.value&&a.value){let e=0;const t=o.value.getBoundingClientRect(),n=a.value.getBoundingClientRect();l.value?.$el&&(e=l.value.$el.getBoundingClientRect().height);const i=window.devicePixelRatio||1;m.Z.set("dndAreaLeft",(n.left-t.left)*i),m.Z.set("dndAreaTop",(n.top-t.top)*i),m.Z.set("dndAreaWidth",n.width*i),m.Z.set("dndAreaHeight",(n.height-e)*i)}}function R(e){if(!0===S.value)for(const t of(0,ke.iZ)("pointermove",e))h.default.get("toolCanvasController").onPointerMove(t)}function L(e){if(!0===S.value)for(const t of(0,ke.iZ)("pointerup",e))h.default.get("toolCanvasController").onPointerUp(t)}function M(e){"touch"!==e.pointerType&&!0===S.value&&h.default.get("toolCanvasController").onPointerMove(e)}function A(e){"touch"!==e.pointerType&&!0===S.value&&h.default.get("toolCanvasController").onPointerUp(e)}function Z(){d.value=n.value?.clientWidth||0,p.value=r.value?.clientWidth||0,t("resize",{sidebarLeftSize:d.value,sidebarRightSize:p.value})}return(0,i.YP)([v,y,x,w],(()=>{clearTimeout(D),D=window.setTimeout((async()=>{g.value=v.value/(window.devicePixelRatio||1)>f.Z.state.dockHideBreakpoint,await(0,i.Y3)(),P(),Z()}),400)})),(0,i.bv)((async()=>{h.default.state.activeToolGroupRestore&&h.default.dispatch("setActiveTool",{group:h.default.state.activeToolGroupRestore}),g.value=v.value/(window.devicePixelRatio||1)>f.Z.state.dockHideBreakpoint,C.Z.on("app.canvas.calculateDndArea",P),window.addEventListener("touchmove",R),window.addEventListener("touchend",L),window.addEventListener("pointerup",A),window.addEventListener("pointermove",M),t("dnd-ready",{mainElement:a.value}),C.Z.emit("app.canvas.resetTransform")})),(0,i.Ah)((()=>{C.Z.off("app.canvas.calculateDndArea",P),window.removeEventListener("touchmove",R),window.removeEventListener("touchend",L),window.removeEventListener("pointerup",A),window.removeEventListener("pointermove",M)})),{dndContainer:o,main:a,sidebarLeft:n,sidebarLeftSize:d,sidebarRightSize:p,sidebarRight:r,showDock:g,toolbar:l,config:c,canvasState:m.Z.state,activeToolbar:w,activeToolbarPosition:b,dockPosition:T,isCanvasInteractable:S,isActiveToolbarExclusive:k,isPointerInsideMain:u,menuBarPosition:x,onPointerDownMain:function(e){if("touch"!==e.pointerType)return!0===S.value&&h.default.get("toolCanvasController").onPointerDown(e),document.body.focus(),!1},onTouchStartMain:function(e){if(e.preventDefault(),e.target==a.value){const t=document.activeElement;if(t&&t?.blur&&(0,ke.u7)(t)&&t?.blur(),!0===S.value)for(const t of(0,ke.iZ)("pointerdown",e))h.default.get("toolCanvasController").onPointerDown(t)}return document.body.focus(),!1},onResizeLayout:Z,onWheelMain:function(e){!0===S.value&&h.default.get("toolCanvasController").onWheel(e)}}}}),Se=(0,w.Z)(Ce,[["render",function(e,t,o,a,n,s){const l=(0,i.up)("app-layout-menu-bar"),c=(0,i.up)("toolbar"),u=(0,i.up)("app-layout-dock");return(0,i.wg)(),(0,i.iD)("div",{ref:"dndContainer",class:"ogr-layout-dnd-container",style:(0,r.normalizeStyle)({"--ogr-sidebar-left-size":e.sidebarLeftSize+"px","--ogr-sidebar-right-size":e.sidebarRightSize+"px"})},[(0,i._)("header",_,[q,!e.isActiveToolbarExclusive&&e.config.menuBar&&"top"===e.menuBarPosition?((0,i.wg)(),(0,i.j4)(l,{key:0,config:e.config.menuBar,"layout-placement":"top",onResize:e.onResizeLayout},null,8,["config","onResize"])):(0,i.kq)("v-if",!0),e.activeToolbar&&"top"===e.activeToolbarPosition?((0,i.wg)(),(0,i.j4)(c,{key:1,name:e.activeToolbar,class:(0,r.normalizeClass)(["is-top",{"is-overlay":!e.isActiveToolbarExclusive}])},null,8,["name","class"])):(0,i.kq)("v-if",!0)],512),(0,i._)("div",N,[(0,i._)("aside",j,[!e.isActiveToolbarExclusive&&e.config.menuBar&&"left"===e.menuBarPosition?((0,i.wg)(),(0,i.j4)(l,{key:0,config:e.config.menuBar,"layout-placement":"left",onResize:e.onResizeLayout},null,8,["config","onResize"])):(0,i.kq)("v-if",!0),e.showDock&&!e.isActiveToolbarExclusive&&e.config.dock&&"left"===e.dockPosition?((0,i.wg)(),(0,i.j4)(u,{key:1,config:e.config.dock,"layout-placement":"left",onResize:e.onResizeLayout},null,8,["config","onResize"])):(0,i.kq)("v-if",!0)],512),(0,i._)("main",{ref:"main",tabindex:"0",class:(0,r.normalizeClass)([{"ogr-custom-cursor":!!e.canvasState.cursor},e.canvasState.cursor?"ogr-custom-cursor--"+e.canvasState.cursor:null]),style:(0,r.normalizeStyle)({"pointer-events":e.isCanvasInteractable?null:"none"}),onTouchstart:t[0]||(t[0]=(...t)=>e.onTouchStartMain&&e.onTouchStartMain(...t)),onPointerdown:t[1]||(t[1]=(...t)=>e.onPointerDownMain&&e.onPointerDownMain(...t)),onWheel:t[2]||(t[2]=(...t)=>e.onWheelMain&&e.onWheelMain(...t))},null,38),(0,i._)("aside",V,[e.showDock&&!e.isActiveToolbarExclusive&&e.config.dock&&"right"===e.dockPosition?((0,i.wg)(),(0,i.j4)(u,{key:0,config:e.config.dock,"layout-placement":"right",onResize:e.onResizeLayout},null,8,["config","onResize"])):(0,i.kq)("v-if",!0),!e.isActiveToolbarExclusive&&e.config.menuBar&&"right"===e.menuBarPosition?((0,i.wg)(),(0,i.j4)(l,{key:1,config:e.config.menuBar,"layout-placement":"right",onResize:e.onResizeLayout},null,8,["config","onResize"])):(0,i.kq)("v-if",!0)],512)]),(0,i._)("footer",K,[e.activeToolbar&&["bottom","auto"].includes(e.activeToolbarPosition)?((0,i.wg)(),(0,i.j4)(c,{key:0,ref:"toolbar",name:e.activeToolbar,class:(0,r.normalizeClass)(["is-bottom","is-menu-bar-"+e.menuBarPosition,{"is-overlay":!e.isActiveToolbarExclusive}])},null,8,["name","class"])):(0,i.kq)("v-if",!0),!e.isActiveToolbarExclusive&&e.config.menuBar&&"bottom"===e.menuBarPosition?((0,i.wg)(),(0,i.j4)(l,{key:1,config:e.config.menuBar,"layout-placement":"bottom",onResize:e.onResizeLayout},null,8,["config","onResize"])):(0,i.kq)("v-if",!0)],512)],4)}]]),xe=["hidden"],De={class:"ogr-menu-drawer__title"},Pe=["onClick"],Re=[(0,i._)("span",{class:"bi bi-x-circle-fill","aria-hidden":"true"},null,-1)],Le={class:"ogr-menu-drawer__content"},Me=(0,i.aZ)({name:"AppMenuDrawers",directives:{loading:A.ZP.directive},components:{Dock:I,ElScrollbar:(0,i.RC)((()=>o.e(8877).then(o.bind(o,17765)))),Module:O},setup(){const e=(0,s.iH)(),t=(0,s.iH)([]),o=(0,s.iH)(!1);let a=0;const n=(0,s.iH)([]);function r(e){if(e){const t=h.default.get("activeMenuDrawerComponentName")!=e.name;u(),t&&(o.value=!1,n.value.push({type:"dock",id:a++,title:"",visible:!0,placement:e.placement,dock:{name:e.name},size:"medium",immediate:!!e.immediate}),h.default.set("activeMenuDrawerComponentName",e.name))}}function l(e){if(e){const t=h.default.get("activeMenuDrawerComponentName")!=e.name;u(),t&&(o.value=!1,n.value.push({type:"module",id:a++,title:"",visible:!0,placement:e.placement,module:{name:e.name},size:"medium",immediate:!!e.immediate}),h.default.set("activeMenuDrawerComponentName",e.name))}}function c(e){e.visible=!1;let t=!0;for(const e of n.value)if(e.visible){t=!1;break}t&&h.default.set("activeMenuDrawerComponentName",null),o.value=t}function u(t){if(!t||t.target===e.value){for(const e of n.value)e.visible&&c(e);h.default.set("activeMenuDrawerComponentName",null)}}return(0,i.bv)((()=>{C.Z.on("app.menuDrawer.openFromDock",r),C.Z.on("app.menuDrawer.openFromModule",l),C.Z.on("app.menuDrawer.closeAll",u)})),(0,i.Ah)((()=>{C.Z.off("app.menuDrawer.openFromDock",r),C.Z.off("app.menuDrawer.openFromModule",l),C.Z.off("app.menuDrawer.closeAll",u)})),{drawerContainer:e,drawers:t,isAllDrawersClosing:o,menuDrawers:n,onAnimationEndDrawers:function(a){a.target===e.value&&o.value&&(n.value=[]);for(const e in t.value)if(a.target===t.value[e]){const t=n.value.map((e=>e.id)).indexOf(parseFloat(e));!1===n.value[t].visible&&n.value.splice(t,1)}},onMenuDrawerClosed:c,onCloseAllDrawers:u}}}),Ae=(0,w.Z)(Me,[["render",function(e,t,o,a,n,s){const l=(0,i.up)("dock"),c=(0,i.up)("module"),u=(0,i.Q2)("t");return(0,i.wg)(),(0,i.iD)("div",{ref:"drawerContainer",class:(0,r.normalizeClass)(["ogr-menu-drawers",{"is-fade-out":e.isAllDrawersClosing}]),hidden:0===e.menuDrawers.length,onAnimationend:t[0]||(t[0]=t=>e.onAnimationEndDrawers(t)),onClick:t[1]||(t[1]=t=>e.onCloseAllDrawers(t))},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.menuDrawers,(t=>((0,i.wg)(),(0,i.iD)("section",{key:t.id,ref_for:!0,ref:o=>{e.drawers[t.id]=o},class:(0,r.normalizeClass)(["ogr-menu-drawer",["is-open-"+t.placement,{"is-closing":!t.visible,"is-immediate":t.immediate}]])},[(0,i.wy)((0,i._)("h1",De,null,512),[[u,t.title||"empty"]]),(0,i._)("a",{href:"javascript:void(0)",class:"ogr-menu-drawer__close",title:"Close",onClick:o=>e.onMenuDrawerClosed(t)},Re,8,Pe),(0,i._)("div",Le,["dock"===t.type?((0,i.wg)(),(0,i.j4)(l,{key:0,name:t.dock.name,"onUpdate:title":e=>t.title=e,onClose:o=>e.onMenuDrawerClosed(t)},null,8,["name","onUpdate:title","onClose"])):"module"===t.type?((0,i.wg)(),(0,i.j4)(c,{key:1,name:t.module.name,"onUpdate:title":e=>t.title=e,onClose:o=>e.onMenuDrawerClosed(t)},null,8,["name","onUpdate:title","onClose"])):(0,i.kq)("v-if",!0)])],2)))),128))],42,xe)}]]),Ze=["aria-hidden"],Ie={class:"ogr-wait__center"},Ee={style:{width:"100%",height:"5rem"},"element-loading-background":"transparent"},Ge={key:0},ze=["onClick"],Oe=(0,i.aZ)({name:"AppWait",directives:{loading:A.ZP.directive},setup(){(0,k.$b)("$notify");const{waiting:e}=(0,s.BK)(h.default.state),t=(0,s.iH)(!1),o=(0,s.iH)({});function a(e){e&&(null!=o.value[e.id]&&delete o.value[e.id],o.value[e.id]={label:e.label||"",cancelable:e.cancelable||!1},h.default.set("waiting",!0),t.value=!!e.immediate)}function n(e){e&&C.Z.emit("app.wait.stopBlocking",e)}function r(e){e&&(null!=o.value[e.id]&&delete o.value[e.id],0===Object.keys(o.value).length&&h.default.set("waiting",!1))}return(0,i.bv)((()=>{C.Z.on("app.wait.startBlocking",a),C.Z.on("app.wait.cancelBlocking",n),C.Z.on("app.wait.stopBlocking",r)})),(0,i.Ah)((()=>{C.Z.off("app.wait.startBlocking",a),C.Z.off("app.wait.cancelBlocking",n),C.Z.off("app.wait.stopBlocking",r)})),{waiting:e,notifications:o,isImmediate:t,onClickCancel:function(e){C.Z.emit("app.wait.cancelBlocking",{id:e})}}}}),Be=(0,w.Z)(Oe,[["render",function(e,t,o,a,n,s){const l=(0,i.Q2)("loading"),c=(0,i.Q2)("t");return(0,i.wg)(),(0,i.iD)("div",{class:(0,r.normalizeClass)(["ogr-wait",{"is-immediate":e.isImmediate}]),"aria-hidden":!e.waiting},[(0,i._)("div",Ie,[(0,i.wy)((0,i._)("div",Ee,null,512),[[l,!0]]),(0,i.wy)((0,i._)("strong",null,null,512),[[c,"app.wait.pleaseWait"]]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.notifications,((t,o)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:t},[t.label?(0,i.wy)(((0,i.wg)(),(0,i.iD)("p",Ge,null,512)),[[c,t.label]]):(0,i.kq)("v-if",!0),t.cancelable?(0,i.wy)(((0,i.wg)(),(0,i.iD)("button",{key:1,type:"button",size:"small",class:"el-button",onClick:t=>e.onClickCancel(o)},null,8,ze)),[[c,"app.wait.cancel"]]):(0,i.kq)("v-if",!0)],64)))),128))])],10,Ze)}]]),He=Be;var Ue=o(91033);const Fe=(0,i.aZ)({name:"App",components:{AppCanvas:D,AppDialogs:H,AppDndDropOverlay:X,AppLayoutDndContainer:Se,AppMenuDrawers:Ae,AppWait:He},setup(){const e=(0,s.iH)(null),t=(0,s.iH)(null),a=(0,s.iH)(!1),n=(0,s.iH)(),r=(0,s.iH)(0),l=(0,s.iH)(0);function c(t){const o=t.target;e.value.contains(o)&&t.preventDefault()}function u(e){a.value=!0,e.preventDefault()}function d(e){e.preventDefault()}function p(e){n.value&&e.target===n.value.$el&&(a.value=!1)}async function g(e){if(e.preventDefault(),a.value=!1,e.dataTransfer&&e.dataTransfer.files?.length>0){C.Z.emit("app.wait.startBlocking",{id:"documentDropFiles",label:"app.wait.loadingImage"});const{openFromFileList:t}=await Promise.all([o.e(8107),o.e(8341),o.e(8658)]).then(o.bind(o,24786));await t(e.dataTransfer.files,{insert:!0}),C.Z.emit("app.wait.stopBlocking",{id:"documentDropFiles"}),C.Z.emit("app.workingFile.notifyImageLoadedFromDragAndDrop")}}function v(e){window.removeEventListener("touchstart",v),h.default.set("isTouchUser",!0)}function y(t){m.Z.set({viewWidth:e.value.clientWidth*(window.devicePixelRatio||1),viewHeight:e.value.clientHeight*(window.devicePixelRatio||1)})}return(0,i.bv)((()=>{if(C.Z.emit("app.wait.startBlocking",{id:"appInitialLoad",immediate:!0}),document.body.classList.contains("ogr-full-page")){try{document.firstElementChild.style.zoom="reset"}catch(e){}const e=setInterval((()=>{window.document.documentElement.scrollTop=0,window.document.documentElement.scrollLeft=0}),250);setTimeout((()=>{clearInterval(e)}),1e4)}document.addEventListener("contextmenu",c),void 0!==Ue.Z?new Ue.Z((t=>{for(let o of t)if(o.target===e.value){const e=o.contentRect;m.Z.set({viewWidth:e.width*(window.devicePixelRatio||1),viewHeight:e.height*(window.devicePixelRatio||1)})}})).observe(e.value):window.addEventListener("resize",y),window.addEventListener("dragenter",u,!0),window.addEventListener("dragover",d,!0),window.addEventListener("dragleave",p,!0),window.addEventListener("drop",g,!0),h.default.set("isTouchUser",!1),window.addEventListener("touchstart",v,!0);const t=document.querySelector(".opengraphica"),o=document.querySelector('[id^="el-popper-container"]');t&&o&&t.appendChild(o),async function(){if(await(0,ge.Qm)(),f.Z.get("showWelcomeScreenAtStart")){const e=(0,ge.Rg)("tutorial","welcome");e&&C.Z.emit("app.menuDrawer.openFromModule",{name:e.action.target,placement:{left:"right",right:"left",top:"bottom",bottom:"top"}[f.Z.get("menuBarPosition")],immediate:!0})}C.Z.emit("app.wait.stopBlocking",{id:"appInitialLoad"})}()})),(0,i.Ah)((()=>{document.removeEventListener("contextmenu",c),window.removeEventListener("resize",y),window.removeEventListener("dragenter",u),window.removeEventListener("dragover",d),window.removeEventListener("dragleave",p),window.removeEventListener("drop",g)})),(0,i.JJ)("rootElement",e),(0,i.JJ)("mainElement",t),{root:e,sidebarLeftSize:r,sidebarRightSize:l,onDndLayoutReady:function({mainElement:e}){t.value=e},onResizeLayoutContainer:function({sidebarLeftSize:e,sidebarRightSize:t}){r.value=e,l.value=t},showDndDropOverlay:a,dndDropOverlay:n,onTouchStartRoot:function(e){e.touches.length>1&&e.preventDefault()}}}}),Ye=(0,w.Z)(Fe,[["render",function(e,t,o,a,n,s){const l=(0,i.up)("app-canvas"),c=(0,i.up)("app-layout-dnd-container"),u=(0,i.up)("app-menu-drawers"),d=(0,i.up)("app-dialogs"),p=(0,i.up)("app-wait"),m=(0,i.up)("app-dnd-drop-overlay");return(0,i.wg)(),(0,i.iD)("div",{ref:"root",class:"opengraphica",style:(0,r.normalizeStyle)({"--ogr-sidebar-left-size":e.sidebarLeftSize+"px","--ogr-sidebar-right-size":e.sidebarRightSize+"px"}),onTouchstart:t[3]||(t[3]=t=>e.onTouchStartRoot(t))},[(0,i.Wm)(l),(0,i.Wm)(c,{onDndReady:t[0]||(t[0]=t=>e.onDndLayoutReady(t)),onResize:t[1]||(t[1]=t=>e.onResizeLayoutContainer(t))}),(0,i.Wm)(u),(0,i.Wm)(d),(0,i.Wm)(p),e.showDndDropOverlay?((0,i.wg)(),(0,i.j4)(m,{key:0,ref:"dndDropOverlay",onClick:t[2]||(t[2]=t=>e.showDndDropOverlay=!1)},null,512)):(0,i.kq)("v-if",!0)],36)}]]);o(8778);var We=o(26670);o(10177);const Xe=(0,a.createApp)(Ye);Xe.use(n.Z),Xe.use(We.ZP),Xe.provide("$notify",(0,k.Rl)(Xe.config.globalProperties.$notify)),C.Z.on("app.notify",(e=>{const t=(0,k.Rl)(Xe.config.globalProperties.$notify)(e);e?.onCreated&&e.onCreated(t)})),Xe.on=C.Z.on,Xe.off=C.Z.off,Xe.emit=C.Z.emit,Xe.theme=async e=>(await h.default.dispatch("setThemes",e),Xe);const _e=[];if(C.Z.on("app.component.register",(e=>{e.name&&!_e.includes(e.name)&&(Xe.component(e),_e.push(e.name))})),window.webpackHotUpdateOpenGraphica){const e=document.createElement("div");e.id="opengraphica",document.body.append(e),document.body.className="ogr-full-page",Xe.theme({light:"./css/main-light.css"}).then((()=>{Xe.mount("#opengraphica")})),setTimeout((()=>{window.OpenGraphica=Xe}),50),document.title="OpenGraphica - Dev"}const qe=Xe},9723:(e,t,o)=>{"use strict";o.d(t,{Rg:()=>l,Qm:()=>s,Mz:()=>c});var a=o(2262);const n=JSON.parse('{"file":{"name":"moduleGroup.file.name","description":"moduleGroup.file.description","modules":{"new":{"name":"moduleGroup.file.modules.new.name","description":"moduleGroup.file.modules.new.description","action":{"type":"ui","target":"file-new"}},"open":{"name":"moduleGroup.file.modules.open.name","description":"moduleGroup.file.modules.open.description","action":{"type":"function","target":"file/open.openFromFileDialog"},"preload":true,"cancelable":true},"export":{"name":"moduleGroup.file.modules.export.name","description":"moduleGroup.file.modules.export.description","action":{"type":"ui","target":"file-export"}},"saveAs":{"name":"moduleGroup.file.modules.saveAs.name","description":"moduleGroup.file.modules.saveAs.description","action":{"type":"ui","target":"file-save-as"}},"insertPhoto":{"name":"moduleGroup.file.modules.insertPhoto.name","description":"moduleGroup.file.modules.insertPhoto.description","action":{"type":"function","target":"file/open.insertFromFileDialog"},"cancelable":true},"takePhoto":{"name":"moduleGroup.file.modules.takePhoto.name","description":"moduleGroup.file.modules.takePhoto.description","action":{"type":"ui","target":"file-take-photo"}},"quickSave":{"name":"moduleGroup.file.modules.quickSave.name","description":"moduleGroup.file.modules.quickSave.description","action":{"type":"function","target":"file/save.saveImageToTemporaryStorage"}},"quickLoad":{"name":"moduleGroup.file.modules.quickLoad.name","description":"moduleGroup.file.modules.quickLoad.description","action":{"type":"function","target":"file/open.openFromTemporaryStorage"}}}},"history":{"name":"moduleGroup.history.name","description":"moduleGroup.history.description","modules":{"redo":{"name":"moduleGroup.history.modules.redo.name","description":"moduleGroup.history.modules.redo.description","action":{"type":"function","target":"history/tracking.redo"}},"undo":{"name":"moduleGroup.history.modules.undo.name","description":"moduleGroup.history.modules.undo.description","action":{"type":"function","target":"history/tracking.undo"}}}},"image":{"name":"moduleGroup.image.name","description":"moduleGroup.image.description","modules":{"convertLayersToImageSequence":{"name":"moduleGroup.image.modules.convertLayersToImageSequence.name","description":"moduleGroup.image.modules.convertLayersToImageSequence.description","action":{"type":"ui","target":"image-convert-layers-to-image-sequence"}},"copy":{"name":"moduleGroup.image.modules.copy.name","description":"moduleGroup.image.modules.copy.description","action":{"type":"function","target":"image/copy.copySelectedLayers"}},"copyAll":{"name":"moduleGroup.image.modules.copyAll.name","description":"moduleGroup.image.modules.copyAll.description","action":{"type":"function","target":"image/copy.copyAllLayers"}},"cut":{"name":"moduleGroup.image.modules.cut.name","description":"moduleGroup.image.modules.cut.description","action":{"type":"function","target":"image/copy.cutSelectedLayers"}},"paste":{"name":"moduleGroup.image.modules.paste.name","description":"moduleGroup.image.modules.paste.description","action":{"type":"function","target":"image/paste.paste"}}}},"tutorial":{"name":"moduleGroup.tutorial.name","description":"moduleGroup.tutorial.description","modules":{"welcome":{"name":"moduleGroup.tutorial.modules.welcome.name","description":"moduleGroup.tutorial.modules.welcome.description","action":{"type":"ui","target":"tutorial-welcome"}}}},"tmp":{"name":"moduleGroup.tmp.name","description":"moduleGroup.tmp.description","modules":{"notYetImplemented":{"name":"moduleGroup.tmp.modules.notYetImplemented.name","description":"moduleGroup.tmp.modules.notYetImplemented.description","action":{"type":"function","target":"tmp/not-yet-implemented.notYetImplemented"}}}}}');var i=o(95452);const r=n;async function s(){const e=[];for(let t in r){const a=r[t];for(let t in a.modules){const n=a.modules[t];if(n.preload&&"function"===n.action.type){const t=n.action.target.split(".")[0].split("/"),a=t[0],i=t[1];a&&i&&e.push(o(72032)(`./${a}/${i}`))}}}await Promise.allSettled(e)}function l(e,t){return r[e]&&r[e].modules[t]||null}async function c(e,t){if(!r[e])throw new Error("Unknown module group name.");{const n=r[e].modules[t];if(!n)throw new Error("Unknown module name.");if("ui"===n.action.type)i.Z.emit("app.dialogs.openFromModule",{name:n.action.target});else if("function"===n.action.type){const t=n.action.target.split("."),r=t[0],s=t[1],l=r.split("/"),c=l[0],u=l[1];if(!(c&&u&&s))throw new Error("Module function identifier was malformed.");{const t=await o(81993)(`./${c}/${u}`),r="runModule_"+e+"_"+u,l=n.cancelable||!1,d=(0,a.iH)(!1),p=e=>{e&&e.id===r&&(d.value=!0)},m={};let h;l&&(i.Z.on("app.wait.cancelBlocking",p),m.cancelRef=d),i.Z.emit("app.wait.startBlocking",{id:r,label:n.name,cancelable:n.cancelable||!1});try{await t[s](m)}catch(e){h=e}if(l&&i.Z.off("app.wait.cancelBlocking",p),i.Z.emit("app.wait.stopBlocking",{id:r}),h)throw h}}}}},90379:()=>{"use strict";window.DOMPoint.prototype.matrixTransform=window.DOMPoint.prototype.matrixTransform||function(e){return(e.is2D||e instanceof SVGMatrix)&&0===this.z&&1===this.w?new DOMPoint(this.x*e.a+this.y*e.c+e.e,this.x*e.b+this.y*e.d+e.f,0,1):new DOMPoint(this.x*e.m11+this.y*e.m21+this.z*e.m31+this.w*e.m41,this.x*e.m12+this.y*e.m22+this.z*e.m32+this.w*e.m42,this.x*e.m13+this.y*e.m23+this.z*e.m33+this.w*e.m43,this.x*e.m14+this.y*e.m24+this.z*e.m34+this.w*e.m44)}},87497:()=>{"use strict";Math.DEGREES_TO_RADIANS=.0174533,Math.RADIANS_TO_DEGREES=57.2958},91648:(e,t,o)=>{"use strict";o.d(t,{Z:()=>c});var a=o(25375),n=o(87521),i=o(22053);const r=i.Z.get("imageSmoothingZoomRatio");let s=document.createElement("canvas");const l=new a.Z({state:{bufferCanvas:s,bufferCtx:s.getContext("2d"),cursor:null,cursorX:0,cursorY:0,decomposedTransform:(0,n.cV)(new DOMMatrix),dirty:!0,dndAreaLeft:0,dndAreaTop:0,dndAreaWidth:1,dndAreaHeight:1,isBufferInUse:!1,isDisplayingNonRasterLayer:!1,playingAnimation:!1,preventPostProcess:!1,renderer:"2d",selectionMaskCanvas:s,threejsCamera:null,threejsRenderer:null,threejsScene:null,transform:new DOMMatrix,transformResetOptions:void 0,useCssCanvas:!0,useCssViewport:!1,viewCanvas:s,viewCtx:s.getContext("2d"),viewDirty:!0,viewHeight:100,viewWidth:100,workingImageBorderColor:"#cccccc"},nonReactive:["bufferCanvas","bufferCtx","isDisplayingNonRasterLayer","selectionMaskCanvas","viewCanvas","viewCtx"],onSet(e,t,o){if("transform"===e){const e=l.state.decomposedTransform,a=(0,n.cV)(t);o("decomposedTransform",a),o("useCssViewport","2d"!==l.state.renderer||!i.Z.get("useCanvasViewport")&&!(l.get("isDisplayingNonRasterLayer")&&a.scaleX>1)),o("transformResetOptions",void 0);const s=r*window.devicePixelRatio;(e.scaleX>s&&a.scaleX<=s||e.scaleX<=s&&a.scaleX>s)&&o("dirty",!0)}},onDispatch(e,t,o){switch(e){case"setTransformRotation":case"setTransformScale":case"setTransformTranslate":case"setTransformFlipX":case"setTransformFlipY":const o=l.get("viewCanvas"),a=l.get("decomposedTransform");let n=0,i=0,r=0;const s=l.get("transform"),c=s.inverse();let u=l.get("dndAreaLeft")+l.get("dndAreaWidth")/2,d=l.get("dndAreaTop")+l.get("dndAreaHeight")/2,p=new DOMPoint(u,d).matrixTransform(c);const m=new DOMPoint(o.width/2,o.height/2);"setTransformRotation"===e?(n=(t-a.rotation)*Math.RADIANS_TO_DEGREES,p=m):"setTransformScale"===e?(i=t/a.scaleX,r=i):"setTransformTranslate"===e?(a.translateX=t.x,a.translateY=t.y):"setTransformFlipX"===e?(i=-1,r=1,p=m):"setTransformFlipY"===e&&(i=1,r=-1,p=m),s.translateSelf(p.x,p.y),(i||r)&&s.scaleSelf(i,r),n&&s.rotateSelf(n),s.translateSelf(-p.x,-p.y),l.set("transform",s),l.set("viewDirty",!0)}}});s=null;const c=l},19971:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>m,updateRasterSequenceLayerWithTimeline:()=>p});var a=o(25375),n=o(84510);const i=JSON.parse('{"draw":{"name":"toolGroup.draw.name","description":"toolGroup.draw.description","tools":{"brush":{"name":"toolGroup.draw.tools.brush.name","description":"toolGroup.draw.tools.brush.description","controller":"free-transform"}}},"image":{"name":"toolGroup.image.name","description":"toolGroup.image.description","tools":{"cropResize":{"name":"toolGroup.image.tools.cropResize.name","description":"toolGroup.image.tools.cropResize.description","controller":"crop-resize","toolbar":{"exclusive":true,"position":"top","target":"crop-resize"},"overlays":["crop-resize"]}}},"selection":{"name":"toolGroup.selection.name","description":"toolGroup.selection.description","tools":{"selection":{"name":"toolGroup.selection.tools.selection.name","description":"toolGroup.selection.tools.selection.description","controller":"selection","toolbar":{"position":"auto","target":"selection"},"overlays":["selection"]}}},"text":{"name":"toolGroup.text.name","description":"toolGroup.text.description","tools":{"text":{"name":"toolGroup.text.tools.text.name","description":"toolGroup.text.tools.text.description","controller":"text","toolbar":{"position":"auto","target":"text"},"overlays":["free-transform","text"]}}},"transform":{"name":"toolGroup.transform.name","description":"toolGroup.transform.description","tools":{"freeTransform":{"name":"toolGroup.transform.tools.freeTransform.name","description":"toolGroup.transform.tools.freeTransform.description","controller":"free-transform","toolbar":{"position":"auto","target":"free-transform"},"overlays":["free-transform"]}}},"view":{"name":"toolGroup.view.name","description":"toolGroup.view.description","tools":{"zoom":{"name":"toolGroup.view.tools.zoom.name","description":"toolGroup.view.tools.zoom.description","controller":"zoom","toolbar":{"position":"auto","target":"zoom"}}}}}');var r=o(91648),s=o(67340);const l=i;let c=0;const u=new a.Z({state:{activeMenuDrawerComponentName:null,activePopoverIds:[],activeTheme:null,activeTool:null,activeToolGroup:null,activeToolGroupPrevious:null,activeToolGroupRestore:null,activeToolPrevious:null,activeToolbar:null,activeToolbarPosition:"top",activeToolOverlays:[],clipboardBufferImageHash:null,clipboardBufferLayers:[],clipboardBufferUpdateTimestamp:0,hasClipboardUpdateSupport:!1,isActiveToolbarExclusive:!1,isTaskRunning:!1,isTouchUser:!0,loadingThemeName:null,tasks:[],themes:{},timelineCursor:0,timelineEnd:0,timelinePlayStartTime:0,timelineStart:0,toolCanvasController:new n.default,tutorialFlags:{},waiting:!1},readOnly:["activeTheme","activeTool","activeToolGroup","themes","timelineCursor"],restore:["activeToolGroupRestore","isTouchUser","tutorialFlags"],async onDispatch(e,t,a){switch(e){case"addTutorialFlag":const e=u.state.tutorialFlags;e[t]||(e[t]=!0,a("tutorialFlags",e));break;case"scheduleTask":const i=t;let s=u.get("tasks");if("clearQueue"===i.priority){for(let e of s)e.isCanceled=!0;a("isTaskRunning",!1),s=[]}s.push(i),s[0]===i&&async function(e,t){if(!u.get("isTaskRunning")){t("isTaskRunning",!0);let o=u.get("tasks");for(;o.length>0;){let a=o[0];if(await a.handler({isCanceled:()=>o[0].isCanceled||!1}),e!==c)return;o=u.get("tasks"),a===o[0]&&o.shift(),t("tasks",o)}t("isTaskRunning",!1)}}(++c,a),a("tasks",s);break;case"setActiveTheme":const p=t,m=u.state.themes;if(m[p]){let e;u.state.activeTheme&&(e=u.state.activeTheme.linkElement),a("loadingThemeName",p);const t=await(n=m[p],new Promise((async(e,t)=>{const o=document.head,a=document.createElement("link");a.type="text/css",a.rel="stylesheet",a.onload=()=>{e(a)},a.onerror=e=>{t(e)},a.href=n,o.appendChild(a)})));await a("activeTheme",{name:p,linkElement:t}),a("loadingThemeName",null),e&&e.parentNode&&e.parentNode.removeChild(e)}break;case"setActiveTool":let{tool:h,group:g}=t,f=h||null;const v=u.get("activeToolGroup");if(h||(f=Object.keys(l[g]?.tools||[])[0]),g!==v||f!==u.get("activeTool")){const e=l[g]?.tools[f||""];let t,n=!1,i=null,r="top",s=[],c="base-movement";if(e?.controller&&(c=e.controller),t=new(0,(await o(78459)(`./${c}.ts`)).default),this.state.toolCanvasController)try{this.state.toolCanvasController.onLeave()}catch(e){console.error(e)}a("toolCanvasController",t),e?.toolbar&&(n=!!e.toolbar.exclusive,r=e.toolbar.position||"top",i=e.toolbar.target),e?.overlays&&(s=e.overlays),a("activeToolGroupPrevious",u.get("activeToolGroup")),a("activeToolGroup",g),a("activeToolGroupRestore",g),a("activeToolbar",i),a("isActiveToolbarExclusive",n),a("activeToolbarPosition",r),a("activeToolPrevious",u.get("activeTool")),a("activeToolOverlays",s),a("activeTool",f);try{u.get("toolCanvasController").onEnter()}catch(e){}}break;case"setThemes":a("themes",t);const y=Object.keys(t);y.length>0&&await u.dispatch("setActiveTheme",y[0]);break;case"setTimelineCursor":a("timelineCursor",t),d(),r.Z.set("dirty",!0)}var n}});function d(e){e=e||s.default.get("layers");for(let t of e)"rasterSequence"===t.type?p(t):"group"===t.type&&d(t.layers)}function p(e){const t=u.get("timelineCursor");for(let o of e.data.sequence)if(o.start<=t&&o.end>t){e.data.currentFrame=o.image;break}}const m=u},8778:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l});var a=o(25375),n=o(22053),i=o(93249),r=o(95452);const s=new a.Z({state:{actionStack:[],actionStackIndex:0,actionStackUpdateToggle:!1,canUndo:!1,canRedo:!1},readOnly:["actionStack"],async onDispatch(e,t,o){switch(e){case"free":return async function({databaseSize:e,memorySize:t},o){let a=s.get("actionStack"),n=s.get("actionStackIndex"),i=0,r=0,l=!1,c=!1;for(;n>0;){let o=a.shift();if(o){i+=o.freeEstimates.memory,r+=o.freeEstimates.database;try{await o.free()}catch(e){l=!0}if(i>=(t||0)&&r>=(e||0)){c=!0;break}}n--}if(!c)for(let o=a.length-1;o>=0;o--){let n=a[o];i+=n.freeEstimates.memory,r+=n.freeEstimates.database;try{await n.free()}catch(e){l=!0}if(i>=(t||0)&&r>=(e||0)){c=!0;break}}return o("actionStack",a),o("actionStackIndex",n),o("actionStackUpdateToggle",!s.state.actionStackUpdateToggle),o("canUndo",n>0),o("canRedo",n<a.length),{totalMemoryFreed:i,totalDatabaseFreed:r}}(t,o);case"redo":return async function(e){if(!s.get("canRedo"))throw new Error("There's nothing to redo.");{const t=s.get("actionStack");let o=s.get("actionStackIndex");const a=t[o];await a.do(),o++,e("actionStackIndex",o),e("actionStackUpdateToggle",!s.state.actionStackUpdateToggle),e("canUndo",o>0),e("canRedo",o<t.length),r.Z.emit("editor.history.step",{trigger:"redo",action:{id:a.id}})}}(o);case"runAction":return async function({action:e,mergeWithHistory:t},o){let a=s.get("actionStack"),l=s.get("actionStackIndex"),c=!1;try{await e.do()}catch(e){return{status:"aborted",reason:e}}if(l<a.length){const e=a.slice(l,a.length).reverse();a=a.slice(0,l);for(let t of e)try{await t.free()}catch(e){c=!0}}const u=a[a.length-1];if(t&&u)"string"==typeof t&&(t=[t]),t.includes(u.id)&&(a[a.length-1]=new i.x(u.id,u.description,[u,e]));else if(a.push(e),a.length>n.Z.get("historyStatesMax")){let e=a.shift();try{e&&await e.free()}catch(e){c=!0}}else l++;o("actionStack",a),o("actionStackIndex",l),o("actionStackUpdateToggle",!s.state.actionStackUpdateToggle),o("canUndo",l>0),o("canRedo",l<a.length),r.Z.emit("editor.history.step",{trigger:"do",action:{id:e.id}});const d=window.performance;return d.memory&&d.memory.usedJSHeapSize>.8*d.memory.jsHeapSizeLimit&&await s.dispatch("free",{memorySize:.2*d.memory.jsHeapSizeLimit}),{status:"completed"}}(t,o);case"undo":return async function(e){if(!s.get("canUndo"))throw new Error("There's nothing to undo.");{const t=s.get("actionStack");let o=s.get("actionStackIndex");o--,await t[o].undo(),e("actionStackIndex",o),e("actionStackUpdateToggle",!s.state.actionStackUpdateToggle),e("canUndo",o>0),e("canRedo",o<t.length),r.Z.emit("editor.history.step",{trigger:"undo",action:{id:t[o].id}})}}(o)}}});window.historyStore=s;const l=s},25375:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});var a=o(2262);const n="openGraphicaStore_";class i{staticState;reactiveState;nonReactiveProps=[];readOnlyProps=[];restoreProps=[];onSet;onDispatch;state;constructor(e){this.staticState=e.state,this.nonReactiveProps=e.nonReactive||[],this.readOnlyProps=e.readOnly||[],this.restoreProps=e.restore||[],e.onSet&&(this.onSet=e.onSet),e.onDispatch&&(this.onDispatch=e.onDispatch);const t={};for(let e in this.staticState)this.nonReactiveProps.includes(e)?t[e]=void 0:t[e]=this.staticState[e];this.reactiveState=(0,a.qj)(t),this.state=(0,a.YS)(this.reactiveState);for(const e of this.restoreProps){let t=null;try{t=localStorage.getItem(n+e)}catch(e){}if(null!=t){const o=t.split(";")[0];let a=t.replace(o+";","");try{"boolean"===o?a="true"===a:"number"===o?a=parseFloat(a):["array","object"].includes(o)&&(a=JSON.parse(a))}catch(e){}this.staticState[e]=a,this.nonReactiveProps.includes(e)||(this.reactiveState[e]=a)}}}directSet(e,t){if(this.staticState[e]=t,this.nonReactiveProps.includes(e)||(this.reactiveState[e]=t),this.restoreProps.includes(e))try{const o=typeof t;let a=t+"";["object","array"].includes(o)&&(a=JSON.stringify(t)),localStorage.setItem(n+e,o+";"+a)}catch(e){}}set(e,t){if("string"==typeof e){if(this.readOnlyProps.includes(e))return;if(this.onSet)try{const o=this.onSet(e,t,this.directSet.bind(this));void 0!==o&&(t=o)}catch(e){return}this.directSet(e,t)}else for(let t in e)this.set(t,e[t])}get(e){return this.reactiveState[e]||this.staticState[e]}async dispatch(e,t){if(this.onDispatch)return await this.onDispatch(e,t,this.directSet.bind(this))}}},22053:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});const a=new(o(25375).Z)({state:{dockHideBreakpoint:1e3,dockPosition:"right",dragStartRadius:5,enableMultiLayerBuffer:!1,historyStatesMax:50,imageSmoothingZoomRatio:1.25,keyboardMapConfig:[],menuBarPosition:"left",multiTouchDownTimeout:75,multiTouchTapTimeout:175,pointerTapTimeout:150,pointerPressHoldTimeout:500,postProcessInterpolateImage:!0,preferCanvasViewport:!1,renderer:"2d",showTutorialNotifications:!0,showWelcomeScreenAtStart:!0,snapSensitivity:5,tooltipShowDelay:300,touchRotation:"off",useCanvasViewport:!1},restore:["dockPosition","dragStartRadius","historyStatesMax","menuBarPosition","multiTouchDownTimeout","multiTouchTapTimeout","pointerTapTimeout","pointerPressHoldTimeout","renderer","showTutorialNotifications","showWelcomeScreenAtStart","snapSensitivity","tooltipShowDelay","touchRotation"]})},67340:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>p,calculateLayerOrder:()=>n,getLayerById:()=>i,getLayerGlobalTransform:()=>r,getLayersByType:()=>l,getGroupLayerById:()=>s,getSelectedLayers:()=>c,getTimelineById:()=>u,ensureUniqueLayerSiblingName:()=>d});const a=new(o(25375).Z)({state:{activeTimelineId:null,background:{visible:!0,color:{is:"color",r:1,g:1,b:1,a:1,style:"#ffffff"}},colorModel:"rgba",colorSpace:"sRGB",drawOriginX:0,drawOriginY:0,fileHandle:null,fileName:"",height:892,layerIdCounter:0,layers:[],measuringUnits:"px",resolutionUnits:"px/in",resolutionX:300,resolutionY:300,scaleFactor:1,selectedLayerIds:[],timelineIdCounter:0,timelines:[],width:818},nonReactive:["fileHandle"]});function n(e,t=0){e||(e=a.get("layers"));for(const o of e)o.renderer.reorder(t),t++,"group"===o.type&&(t=n(o.layers,t));return t}function i(e,t){null==t&&(t=a.get("layers"));for(let o of t){if(o.id===e)return o;if("group"===o.type){let t=i(e,o.layers);if(t)return t}}return null}function r(e){let t=null;t="number"==typeof e?i(e):e;let o=new DOMMatrix;return t&&(null!=t.groupId&&o.multiplySelf(r(t.groupId)),o.multiplySelf(t.transform)),o}function s(e,t){null==t&&(t=a.get("layers"));const o=i(e,t);return o&&"group"===o.type?o:null}function l(e,t){null==t&&(t=a.get("layers"));let o=[];for(let a of t)a.type===e&&o.push(a),"group"===a.type&&(o=o.concat(l(e,a.layers)));return o}function c(){const e=[],t=a.get("selectedLayerIds");if(t.length>0)for(let o of t){const t=i(o);t&&e.push(t)}return e}function u(e){const t=a.get("timelines");for(let o of t)if(o.id===e)return o;return null}function d(e,t){if(null!=e){let o=[];const n=i(e);o=null!=n?.groupId?s(n.groupId)?.layers||[]:a.get("layers");let r=-1;t=t.replace(/\s#[0-9]{1,}$/g,"");for(let e of o)if(e.name.replace(/\s#[0-9]{1,}$/g,"")===t){let t=e.name.split("#").pop()+"",o=0;/^[0-9]{1,}$/g.test(t)&&(o=parseInt(t)),o>r&&(r=o)}r>=0&&(t=t+" #"+(r+1))}return t}const p=a},20608:(e,t,o)=>{"use strict";o.d(t,{Z:()=>g});var a=o(66252),n=o(3577);const i={key:0,class:"el-popover__title",role:"title"};var r=o(2262),s=o(53430),l=o(35450),c=o(49980),u=o(99997),d=o(19971);let p=null,m=0;const h=(0,a.aZ)({name:"ElPopover",components:{ElTooltip:s.default},props:{appendTo:u.useTooltipContentProps.appendTo,visible:u.useTooltipContentProps.visible,...c.usePopoverProps},emits:["update:visible","after-enter","after-leave"],setup(e,{emit:t}){let o=!1;const n=m++,i=(0,r.iH)(null),s=(0,a.Fl)((()=>(0,r.SU)(i)?.popperRef)),c=(0,a.Fl)((()=>(0,l.isString)(e.width)?e.width:`${e.width}px`));(0,a.YP)((()=>e.visible),(e=>{if(!p){const e=document.querySelector(".opengraphica");e&&(p=document.querySelector('[id^="el-popper-container"]'),e.appendChild(p))}}));const u=(0,a.Fl)((()=>[{width:c.value},e.popperStyle])),h=(0,a.Fl)((()=>[{"el-popover--plain":!!e.content},"el-popover",e.popperClass]));return(0,a.bv)((()=>{o=!0})),(0,a.Ah)((()=>{o=!1,d.default.set("activePopoverIds",d.default.get("activePopoverIds").filter((e=>e!==n)))})),{kls:h,style:u,tooltipRef:i,popperRef:s,hide:()=>{i.value?.hide()},afterEnter:()=>{const e=d.default.get("activePopoverIds");!e.includes(n)&&o&&(e.push(n),d.default.set("activePopoverIds",e)),t("after-enter")},afterLeave:()=>{d.default.set("activePopoverIds",d.default.get("activePopoverIds").filter((e=>e!==n))),t("after-leave")}}}}),g=(0,o(83744).Z)(h,[["render",function(e,t,o,r,s,l){const c=(0,a.up)("el-tooltip");return(0,a.wg)(),(0,a.j4)(c,(0,a.dG)({ref:"tooltipRef"},e.$attrs,{"aria-label":e.title,effect:e.effect,enterable:e.enterable,"popper-class":e.kls,"popper-style":e.style,"append-to":e.appendTo,visible:e.visible,persistent:"",onShow:e.afterEnter,onHide:e.afterLeave}),{content:(0,a.w5)((()=>[e.title?((0,a.wg)(),(0,a.iD)("div",i,(0,n.toDisplayString)(e.title),1)):(0,a.kq)("v-if",!0),(0,a.WI)(e.$slots,"default",{},(()=>[(0,a.Uk)((0,n.toDisplayString)(e.content),1)]))])),default:(0,a.w5)((()=>[e.$slots.reference?(0,a.WI)(e.$slots,"reference",{key:0}):(0,a.kq)("v-if",!0)])),_:3},16,["aria-label","effect","enterable","popper-class","popper-style","append-to","visible","onShow","onHide"])}]])},78459:(e,t,o)=>{var a={"./base-movement.ts":[84510],"./base.ts":[62195],"./crop-resize.ts":[12058,6617,9899],"./free-transform.ts":[56742,8107,4586,2435,4151,800],"./selection.ts":[14689,8107,4586,2435,4440],"./text.ts":[75877,8107,4586,2435,4151,800,9640],"./zoom.ts":[22718,4586,2435,6280]};function n(e){if(!o.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],n=t[0];return Promise.all(t.slice(1).map(o.e)).then((()=>o(n)))}n.keys=()=>Object.keys(a),n.id=78459,e.exports=n},74119:(e,t,o)=>{window.OpenGraphica=o(28398).Z,e.exports=window.OpenGraphica},81993:(e,t,o)=>{var a={"./file/export":[13088,9,4736,8341,2912],"./file/export.ts":[13088,9,4736,8341,2912],"./file/new":[71401,9,8107,7063],"./file/new.ts":[71401,9,8107,7063],"./file/open":[24786,9,8107,8341,8658],"./file/open.ts":[24786,9,8107,8341,8658],"./file/save":[15683,9,4736,9592],"./file/save.ts":[15683,9,4736,9592],"./history/tracking":[13302,9,7741],"./history/tracking.ts":[13302,9,7741],"./image/conversion":[48870,9,8107,1286],"./image/conversion.ts":[48870,9,8107,1286],"./image/copy":[19533,9,4736,8107,1196],"./image/copy.ts":[19533,9,4736,8107,1196],"./image/paste":[23233,9,4736,8107,2677],"./image/paste.ts":[23233,9,4736,8107,2677],"./image/trim":[30371,7,6275],"./image/trim.ts":[30371,7,6275],"./tmp/not-yet-implemented":[43966,9,7943],"./tmp/not-yet-implemented.ts":[43966,9,7943]};function n(e){if(!o.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],n=t[0];return Promise.all(t.slice(2).map(o.e)).then((()=>o.t(n,16|t[1])))}n.keys=()=>Object.keys(a),n.id=81993,e.exports=n},72032:(e,t,o)=>{var a={"./file/export":[13088,9,4736,8341,2912],"./file/export.ts":[13088,9,4736,8341,2912],"./file/new":[71401,9,8107,7063],"./file/new.ts":[71401,9,8107,7063],"./file/open":[24786,9,8107,8341,8658],"./file/open.ts":[24786,9,8107,8341,8658],"./file/save":[15683,9,4736,9592],"./file/save.ts":[15683,9,4736,9592],"./history/tracking":[13302,9,7741],"./history/tracking.ts":[13302,9,7741],"./image/conversion":[48870,9,8107,1286],"./image/conversion.ts":[48870,9,8107,1286],"./image/copy":[19533,9,4736,8107,1196],"./image/copy.ts":[19533,9,4736,8107,1196],"./image/paste":[23233,9,4736,8107,2677],"./image/paste.ts":[23233,9,4736,8107,2677],"./image/trim":[30371,7,6275],"./image/trim.ts":[30371,7,6275],"./tmp/not-yet-implemented":[43966,9,7943],"./tmp/not-yet-implemented.ts":[43966,9,7943]};function n(e){if(!o.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],n=t[0];return Promise.all(t.slice(2).map(o.e)).then((()=>o.t(n,16|t[1])))}n.keys=()=>Object.keys(a),n.id=72032,e.exports=n}},e=>{e.O(0,[4736,376,8107,8154,7485,1559,6201,4966,5851,5429,2540,1920,9587],(()=>(74119,e(e.s=74119))));var t=e.O();OpenGraphica=t}]);