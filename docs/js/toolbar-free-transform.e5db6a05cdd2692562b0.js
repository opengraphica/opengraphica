"use strict";(self.webpackChunkOpenGraphica=self.webpackChunkOpenGraphica||[]).push([[1745],{60463:(e,t,l)=>{l.r(t),l.d(t,{default:()=>U});var a=l(66252),o=l(3577);const n={class:"is-flex container is-align-items-center is-justify-content-center mx-auto"},i={class:"ogr-toolbar-overlay"},u={class:"ogr-toolbar-tool-selector"},r=(0,a._)("span",{class:"bi bi-cursor my-1","aria-hidden":"true"},null,-1),s={class:"ogr-toolbar-tool-selector__description"},p=(0,a._)("span",{class:"bi bi-x-circle-fill mr-2","aria-hidden":"true"},null,-1),m=(0,a._)("span",{class:"bi bi-cursor","aria-hidden":"true"},null,-1),c=(0,a._)("span",{class:"bi bi-magnet-fill mr-2","aria-hidden":"true"},null,-1),v=(0,a._)("span",{class:"bi bi-clipboard-data-fill mr-2","aria-hidden":"true"},null,-1),f={class:"mt-3 mx-4.5"},d={class:"mt-3 mx-4.5"},g={class:"px-4.5 my-3 is-flex"},b=(0,a.Uk)("X"),h=(0,a.Uk)("Y"),w=(0,a._)("span",{class:"bi bi-arrow-repeat","aria-hidden":"true"},null,-1),x={key:1,class:"px-4.5 my-3"};var y=l(2262),k=l(84151),I=l(75710),_=l(26418),L=l(64670),R=l(9069),T=l(2615),V=l(97965),C=l(47204),$=l(98653),W=l(20608),F=l(16131),P=l(10409),S=l(8778),z=l(67340),D=l(63063),H=l(57753);const E=(0,a.aZ)({name:"ToolbarFreeTransform",components:{ElAlert:_.ZP,ElButton:L.ZP,ElButtonGroup:L.MO,ElForm:R.ZP,ElFormItem:R.nH,ElHorizontalScrollbarArrows:T.Z,ElInput:V.default,ElInputGroup:C.Z,ElInputNumber:$.Z,ElOption:F.BT,ElPopover:W.Z,ElSelect:F.ZP,ElSwitch:P.ZP},props:{},emits:["close"],setup(e,{emit:t}){const{selectedLayerIds:l}=(0,y.BK)(z.default.state),o=(0,y.iH)(z.default.get("measuringUnits")),n=(0,y.iH)(z.default.get("resolutionX")),i=(0,y.iH)(z.default.get("resolutionY")),u=(0,y.iH)(z.default.get("resolutionUnits")),r=(0,y.iH)(null),s=(0,y.iH)(),p=(0,y.iH)();let m=!1;const c=(0,y.iH)(0),v=(0,y.iH)(0),f=(0,y.iH)(1),d=(0,y.iH)(1),g=(0,y.iH)(0),b=(0,a.Fl)((()=>!(null==I.Kk.value&&null==I.R_.value)));return(0,a.YP)([k.t$],(([e])=>{m||(c.value=parseFloat((0,D.L3)(e,"px",o.value,n.value,u.value).toFixed(2)))}),{immediate:!0}),(0,a.YP)([k.we],(([e])=>{m||(v.value=parseFloat((0,D.L3)(e,"px",o.value,n.value,u.value).toFixed(2)))}),{immediate:!0}),(0,a.YP)([k.bf,k.Cb],(([e,t])=>{m||(f.value=parseFloat((0,D.L3)(e,"px",o.value,n.value,u.value).toFixed("px"===o.value?0:2)),d.value=parseFloat((0,D.L3)(t,"px",o.value,i.value,u.value).toFixed("px"===o.value?0:2)))}),{immediate:!0}),(0,a.YP)([k.Wn],(([e])=>{m||(g.value=parseFloat((e*Math.RADIANS_TO_DEGREES).toFixed(2)))}),{immediate:!0}),{hasSelection:b,popoverButtonRef:s,currentPopoverName:p,inputLeft:c,inputTop:v,inputWidth:f,inputHeight:d,inputRotation:g,measuringUnits:o,layerPickMode:k.Bb,useRotationSnapping:k.Jk,dimensionLockRatio:r,selectedLayerIds:l,onMouseOverPopoverButton:function(e,t){s.value=e.target?.closest("button"),p.value=t},onClickPopoverButton:function(e,t){s.value=e.target?.closest("button"),p.value=t},onToggleDimensionLockRatio:function(){null==r.value?r.value=k.bf.value/k.Cb.value:r.value=null},onFocusAnyMetricInput:function(){k.V$.emit("storeTransformStart"),m=!0},onInputLeft:function(e){k.V$.emit("previewDragResizeChange",{transform:{left:(0,D.L3)(e,o.value,"px",n.value,u.value),top:(0,D.L3)(v.value,o.value,"px",n.value,u.value),width:(0,D.L3)(f.value,o.value,"px",n.value,u.value),height:(0,D.L3)(d.value,o.value,"px",n.value,u.value)}})},onInputTop:function(e){k.V$.emit("previewDragResizeChange",{transform:{left:(0,D.L3)(c.value,o.value,"px",n.value,u.value),top:(0,D.L3)(e,o.value,"px",n.value,u.value),width:(0,D.L3)(f.value,o.value,"px",n.value,u.value),height:(0,D.L3)(d.value,o.value,"px",n.value,u.value)}})},onInputWidth:function(e){k.V$.emit("previewDragResizeChange",{transform:{left:(0,D.L3)(c.value,o.value,"px",n.value,u.value),top:(0,D.L3)(v.value,o.value,"px",n.value,u.value),width:(0,D.L3)(e,o.value,"px",n.value,u.value),height:(0,D.L3)(d.value,o.value,"px",n.value,u.value)}})},onInputHeight:function(e){k.V$.emit("previewDragResizeChange",{transform:{left:(0,D.L3)(c.value,o.value,"px",n.value,u.value),top:(0,D.L3)(v.value,o.value,"px",n.value,u.value),width:(0,D.L3)(f.value,o.value,"px",n.value,u.value),height:(0,D.L3)(e,o.value,"px",n.value,u.value)}})},onInputRotation:function(e){k.V$.emit("previewRotationChange",{rotation:e*Math.DEGREES_TO_RADIANS})},onChangeDragResizeInput:function(){m=!1,k.V$.emit("commitTransforms")},onChangeRotationInput:function(){m=!1,k.V$.emit("commitTransforms")},onResetRotation:function(){k.V$.emit("storeTransformStart"),k.V$.emit("previewRotationChange",{rotation:0}),k.V$.emit("commitTransforms")},onClickClearSelection:async function(){await S.Z.dispatch("runAction",{action:new H.m})}}}}),U=(0,l(83744).Z)(E,[["render",function(e,t,l,y,k,I){const _=(0,a.up)("el-button"),L=(0,a.up)("el-option"),R=(0,a.up)("el-select"),T=(0,a.up)("el-input-group"),V=(0,a.up)("el-switch"),C=(0,a.up)("el-form-item"),$=(0,a.up)("el-form"),W=(0,a.up)("el-input-number"),F=(0,a.up)("el-alert"),P=(0,a.up)("el-popover"),S=(0,a.up)("el-horizontal-scrollbar-arrows"),z=(0,a.Q2)("t");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",i,[(0,a._)("div",u,[r,(0,a.wy)((0,a._)("span",s,null,512),[[z,"toolbar.general.settings"]])]),(0,a.Wm)(S,null,{default:(0,a.w5)((()=>[e.hasSelection?((0,a.wg)(),(0,a.j4)(_,{key:0,size:"small",onClick:e.onClickClearSelection},{default:(0,a.w5)((()=>[p,(0,a.Uk)(" "+(0,o.toDisplayString)(e.$t("toolbar.freeTransform.clearSelection")),1)])),_:1},8,["onClick"])):((0,a.wg)(),(0,a.j4)(T,{key:1,"prepend-tooltip":e.$t("toolbar.freeTransform.pickLayer.label")},{prepend:(0,a.w5)((()=>[m])),default:(0,a.w5)((()=>[(0,a.Wm)(R,{"aria-label":e.$t("toolbar.freeTransform.pickLayer.label"),modelValue:e.layerPickMode,"onUpdate:modelValue":t[0]||(t[0]=t=>e.layerPickMode=t),size:"small",style:{width:"5rem"}},{default:(0,a.w5)((()=>[(0,a.Wm)(L,{label:e.$t("toolbar.freeTransform.pickLayer.auto"),value:"auto"},null,8,["label"]),(0,a.Wm)(L,{label:e.$t("toolbar.freeTransform.pickLayer.current"),value:"current"},null,8,["label"])])),_:1},8,["aria-label","modelValue"])])),_:1},8,["prepend-tooltip"])),(0,a.Wm)(_,{size:"small",class:"ml-3",onMouseover:t[1]||(t[1]=t=>e.onMouseOverPopoverButton(t,"snapping")),onClick:t[2]||(t[2]=t=>e.onClickPopoverButton(t,"snapping"))},{default:(0,a.w5)((()=>[c,(0,a.Uk)(" "+(0,o.toDisplayString)(e.$t("toolbar.freeTransform.snapping.title")),1)])),_:1}),(0,a.Wm)(_,{size:"small",class:"ml-3",onMouseover:t[3]||(t[3]=t=>e.onMouseOverPopoverButton(t,"metrics")),onClick:t[4]||(t[4]=t=>e.onClickPopoverButton(t,"metrics"))},{default:(0,a.w5)((()=>[v,(0,a.Uk)(" "+(0,o.toDisplayString)(e.$t("toolbar.freeTransform.metrics.title")),1)])),_:1}),(0,a.Wm)(P,{placement:"top","popper-class":"ogr-dock-popover ogr-dock-popper--singleton","virtual-ref":e.popoverButtonRef,trigger:"click","virtual-triggering":"",width:250,"popper-options":{modifiers:[{name:"computeStyles",options:{adaptive:!1,enabled:!1}}]}},{default:(0,a.w5)((()=>["snapping"===e.currentPopoverName?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a.wy)((0,a._)("h2",f,null,512),[[z,"toolbar.freeTransform.snapping.title"]]),(0,a.Wm)($,{novalidate:"novalidate",action:"javascript:void(0)"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{class:"el-form-item--menu-item el-form-item--has-content-right mb-1",label:e.$t("toolbar.freeTransform.snapping.rotationSnap")},{default:(0,a.w5)((()=>[(0,a.Wm)(V,{modelValue:e.useRotationSnapping,"onUpdate:modelValue":t[5]||(t[5]=t=>e.useRotationSnapping=t)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})],64)):"metrics"===e.currentPopoverName?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a.wy)((0,a._)("h2",d,null,512),[[z,"toolbar.freeTransform.metrics.title"]]),e.selectedLayerIds.length>0?((0,a.wg)(),(0,a.j4)($,{key:0,novalidate:"novalidate",action:"javascript:void(0)",style:{"max-width":"15rem"}},{default:(0,a.w5)((()=>[(0,a._)("div",g,[(0,a.Wm)(W,{modelValue:e.inputLeft,"onUpdate:modelValue":t[6]||(t[6]=t=>e.inputLeft=t),"aria-label":"X "+e.$t("toolbar.freeTransform.metrics.position"),size:"small",class:"el-input-group--plain is-flex-grow-1","suffix-text":e.measuringUnits,"blur-on-enter":!0,onFocus:t[7]||(t[7]=t=>e.onFocusAnyMetricInput()),onInput:t[8]||(t[8]=t=>e.onInputLeft(t)),onBlur:t[9]||(t[9]=t=>e.onChangeDragResizeInput())},{prepend:(0,a.w5)((()=>[b])),_:1},8,["modelValue","aria-label","suffix-text"]),(0,a.Wm)(W,{modelValue:e.inputTop,"onUpdate:modelValue":t[10]||(t[10]=t=>e.inputTop=t),"aria-label":"Y "+e.$t("toolbar.freeTransform.metrics.position"),size:"small",class:"el-input-group--plain is-flex-grow-1 ml-3","suffix-text":e.measuringUnits,"blur-on-enter":!0,onFocus:t[11]||(t[11]=t=>e.onFocusAnyMetricInput()),onInput:t[12]||(t[12]=t=>e.onInputTop(t)),onBlur:t[13]||(t[13]=t=>e.onChangeDragResizeInput())},{prepend:(0,a.w5)((()=>[h])),_:1},8,["modelValue","aria-label","suffix-text"])]),(0,a.Wm)(C,{class:"el-form-item--menu-item mb-1",label:e.$t("toolbar.freeTransform.metrics.width")},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{modelValue:e.inputWidth,"onUpdate:modelValue":t[14]||(t[14]=t=>e.inputWidth=t),style:{width:"6rem"},size:"small","suffix-text":e.measuringUnits,"blur-on-enter":!0,onFocus:t[15]||(t[15]=t=>e.onFocusAnyMetricInput()),onInput:t[16]||(t[16]=t=>e.onInputWidth(t)),onBlur:t[17]||(t[17]=t=>e.onChangeDragResizeInput())},null,8,["modelValue","suffix-text"])])),_:1},8,["label"]),(0,a.Wm)(C,{class:"el-form-item--menu-item mb-1",label:e.$t("toolbar.freeTransform.metrics.height")},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{modelValue:e.inputHeight,"onUpdate:modelValue":t[18]||(t[18]=t=>e.inputHeight=t),style:{width:"6rem"},size:"small","suffix-text":e.measuringUnits,"blur-on-enter":!0,onFocus:t[19]||(t[19]=t=>e.onFocusAnyMetricInput()),onInput:t[20]||(t[20]=t=>e.onInputHeight(t)),onBlur:t[21]||(t[21]=t=>e.onChangeDragResizeInput())},null,8,["modelValue","suffix-text"])])),_:1},8,["label"]),(0,a.Wm)(C,{class:"el-form-item--menu-item mb-1",label:e.$t("toolbar.freeTransform.metrics.rotation")},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{modelValue:e.inputRotation,"onUpdate:modelValue":t[23]||(t[23]=t=>e.inputRotation=t),style:{width:"6rem"},size:"small","suffix-text":"°","blur-on-enter":!0,onFocus:t[24]||(t[24]=t=>e.onFocusAnyMetricInput()),onInput:t[25]||(t[25]=t=>e.onInputRotation(t)),onBlur:t[26]||(t[26]=t=>e.onChangeRotationInput(t))},{append:(0,a.w5)((()=>[(0,a.Wm)(_,{size:"small","aria-label":e.$t("toolbar.freeTransform.metrics.resetRotation"),onClick:t[22]||(t[22]=t=>e.onResetRotation())},{default:(0,a.w5)((()=>[w])),_:1},8,["aria-label"])])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1})):((0,a.wg)(),(0,a.iD)("div",x,[(0,a.Wm)(F,{type:"info",title:e.$t("toolbar.freeTransform.metrics.noLayers"),"show-icon":"",closable:!1},null,8,["title"])]))],64)):(0,a.kq)("v-if",!0)])),_:1},8,["virtual-ref"])])),_:1})])])}]])}}]);